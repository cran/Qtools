<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Marco Geraci, University of South Carolina" />


<title>Qtools: A Collection of Models and Tools for Quantile Inference</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>





<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Qtools: A Collection of Models and Tools
for Quantile Inference</h1>
<h4 class="author">Marco Geraci, University of South Carolina</h4>


<div id="TOC">
<ul>
<li><a href="#abstract" id="toc-abstract">Abstract</a></li>
<li><a href="#introduction" id="toc-introduction">Introduction</a></li>
<li><a href="#unconditional-quantiles" id="toc-unconditional-quantiles">Unconditional quantiles</a>
<ul>
<li><a href="#definition-and-estimation-of-quantiles" id="toc-definition-and-estimation-of-quantiles">Definition and
estimation of quantiles</a></li>
<li><a href="#lss---location-scale-and-shape-of-a-distribution" id="toc-lss---location-scale-and-shape-of-a-distribution">LSS -
Location, scale and shape of a distribution</a></li>
</ul></li>
<li><a href="#conditional-quantiles" id="toc-conditional-quantiles">Conditional quantiles</a>
<ul>
<li><a href="#linear-models" id="toc-linear-models">Linear
models</a></li>
<li><a href="#goodness-of-fit" id="toc-goodness-of-fit">Goodness of
fit</a></li>
<li><a href="#transformation-models" id="toc-transformation-models">Transformation models</a></li>
<li><a href="#conditional-lss" id="toc-conditional-lss">Conditional
LSS</a></li>
</ul></li>
<li><a href="#other-functions-in-qtools" id="toc-other-functions-in-qtools">Other functions in
<strong>Qtools</strong></a>
<ul>
<li><a href="#restricted-quantile-regression" id="toc-restricted-quantile-regression">Restricted quantile
regression</a></li>
<li><a href="#conditional-quantiles-of-discrete-data" id="toc-conditional-quantiles-of-discrete-data">Conditional quantiles of
discrete data</a>
<ul>
<li><a href="#jittering-for-count-responses" id="toc-jittering-for-count-responses">Jittering for count
responses</a></li>
<li><a href="#conditional-mid-quantiles-for-discrete-responses" id="toc-conditional-mid-quantiles-for-discrete-responses">Conditional
mid-quantiles for discrete responses</a></li>
</ul></li>
<li><a href="#quantile-based-multiple-imputation" id="toc-quantile-based-multiple-imputation">Quantile-based multiple
imputation</a></li>
</ul></li>
<li><a href="#final-remarks" id="toc-final-remarks">Final
remarks</a></li>
<li><a href="#acknowledgements" id="toc-acknowledgements">Acknowledgements</a></li>
<li><a href="#references" id="toc-references">References</a></li>
</ul>
</div>

<div id="abstract" class="section level1">
<h1>Abstract</h1>
<p>Quantiles play a fundamental role in statistics. The quantile
function defines the distribution of a random variable and, thus,
provides a way to describe the data that is specular but equivalent to
that given by the corresponding cumulative distribution function. There
are many advantages in working with quantiles, starting from their
properties. The renewed interest in their usage seen in the last years
is due to the theoretical, methodological, and software contributions
that have broadened their applicability. This paper presents the R
package <strong>Qtools</strong>, a collection of utilities for
unconditional and conditional quantiles.</p>
</div>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>Quantiles have a long history in applied statistics, especially the
median. The analysis of astronomical data by Galileo Galilei in 1632
<span class="citation">(Hald 2003, 149)</span> and geodic measurements
by Roger Boscovich in 1757 <span class="citation">(Koenker 2005,
2)</span> are presumably the earliest examples of application of the
least absolute deviation (<span class="math inline">\(L_1\)</span>)
estimator in its, respectively, unconditional and conditional forms. The
theoretical studies on quantiles of continuous random variables started
to appear in the statistical literature of the 20th century. In the case
of discrete data, studies have somewhat lagged behind most probably
because of the analytical drawbacks surrounding the discontinuities that
characterise discrete quantile functions. Some forms of approximation to
continuity have been recently proposed to study the large sample
behavior of quantile estimators. For example, <span class="citation">Ma,
Genton, and Parzen (2011)</span> have demonstrated the asymptotic
normality of unconditional sample quantiles based on the definition of
the mid-distribution function <span class="citation">(Parzen
2004)</span>. <span class="citation">Machado and Santos Silva
(2005)</span> proposed inferential approaches to the estimation of
conditional quantiles for counts based on data jittering.</p>
<p>Functions implementing quantile methods can be found in common
statistical software. A considerable number of R packages that provide
such functions are available on the Comprehensive R Archive Network
(CRAN). The base package <strong>stats</strong> contains basic functions
to estimate sample quantiles or compute quantiles of common parametric
distributions. The <strong>quantreg</strong> package <span class="citation">(Koenker 2013)</span> is arguably a benchmark for
distribution-free estimation of linear quantile regression models, as
well as the base for other packages which make use of linear programming
(LP) algorithms <span class="citation">(Koenker and D’Orey 1987; Koenker
and Park 1996)</span>. Other contributions to the modelling of
conditional quantile functions include packages for Bayesian regression,
e.g. <strong>bayesQR</strong> <span class="citation">(Benoit et al.
2014)</span> and <strong>BSquare</strong> <span class="citation">(Smith
and Reich 2013)</span>, and the <strong>lqmm</strong> package <span class="citation">(Geraci and Bottai 2014; Geraci 2014)</span> for
random-effects regression.</p>
<p>The focus of this paper is on the R package <strong>Qtools</strong>,
a collection of models and tools for quantile inference. These include
commands for</p>
<ul>
<li>quantile-based analysis of the location, scale and shape of a
distribution;</li>
<li>transformation-based quantile regression;</li>
<li>goodness of fit and restricted quantile regression;</li>
<li>quantile regression for discrete data;</li>
<li>quantile-based multiple imputation. The emphasis will be put on the
first two topics listed above as they represent the main contribution of
the package, while a short description of the other topics is given for
completeness.</li>
</ul>
</div>
<div id="unconditional-quantiles" class="section level1">
<h1>Unconditional quantiles</h1>
<div id="definition-and-estimation-of-quantiles" class="section level2">
<h2>Definition and estimation of quantiles</h2>
<p>Let <span class="math inline">\(Y\)</span> be a random variable with
cumulative distribution function (CDF) <span class="math inline">\(F_{Y}\)</span> and support <span class="math inline">\(S_{Y}\)</span>. The CDF calculated at <span class="math inline">\(y \in S_{Y}\)</span> returns the probability <span class="math inline">\(F_{Y}(y) \equiv p = \Pr\left(Y \leq
y\right)\)</span>. The quantile function (QF) is defined as <span class="math inline">\(Q(p) = \inf_{y}\{F_{Y}(y) \geq p\}\)</span>, for
<span class="math inline">\(0 &lt; p &lt; 1\)</span>. (Some authors
consider <span class="math inline">\(0 \leq p \leq 1\)</span>. For
practical purposes, it is simpler to exclude the endpoints 0 and 1.)
When <span class="math inline">\(F_{Y}\)</span> is continuous and
strictly monotone (hence, <span class="math inline">\(f_{Y}(y) \equiv
F_{Y}&#39;(y) &gt; 0\)</span> for all <span class="math inline">\(y \in
S_{Y}\)</span>), the quantile function is simply the inverse of <span class="math inline">\(F_{Y}\)</span>. In other cases, the quantile <span class="math inline">\(p\)</span> is defined, by convention, as the
smallest value <span class="math inline">\(y\)</span> such that <span class="math inline">\(F_{Y}(y)\)</span> is at least <span class="math inline">\(p\)</span>.</p>
<p>Quantiles enjoy a number of properties. An excellent overview is
given by <span class="citation">Gilchrist (2000)</span>. In particular,
the <em>Q-tranformation rule</em> <span class="citation">(Gilchrist
2000)</span> or equivariance to monotone transformations states that if
<span class="math inline">\(h(\cdot)\)</span> is a non-decreasing
function on <span class="math inline">\(\mathbb{R}\)</span>, then <span class="math inline">\(Q_{h(Y)}(p) = h\left\{Q_{Y}(p)\right\}\)</span>.
Hence <span class="math inline">\(Q_{Y}(p) =
h^{-1}\left\{Q_{h(Y)}(p)\right\}\)</span>. Note that this property does
not generally hold for the expected value.</p>
<p>Sample quantiles for a random variable <span class="math inline">\(Y\)</span> can be calculated in a number of ways,
depending on how they are defined <span class="citation">(Hyndman and
Fan 1996)</span>. For example, the function <tt>quantile</tt> in the
base package <strong>stats</strong> provides nine different sample
quantile estimators, which are based on the sample order statistics or
the inverse of the empirical CDF. These estimators are distribution-free
as they do not depend on any parametric assumption about <span class="math inline">\(F\)</span> (or <span class="math inline">\(Q\)</span>).</p>
<p>Let <span class="math inline">\(Y_{1}, Y_{2}, \ldots, Y_{n}\)</span>
be a sample of <span class="math inline">\(n\)</span> independent and
identically distributed (<em>iid</em>) observations from the population
<span class="math inline">\(F_{Y}\)</span>. Let <span class="math inline">\(\xi_p\)</span> denote the <span class="math inline">\(p\)</span>th population quantile and <span class="math inline">\(\hat{\xi}_p\)</span> the corresponding sample
quantile. (The subscripts will be dropped occasionally to ease notation,
e.g. <span class="math inline">\(F\)</span> will be used in place of
<span class="math inline">\(F_{Y}\)</span> or <span class="math inline">\(\xi\)</span> in place of <span class="math inline">\(\xi_{p}\)</span>.) In the continuous case, it is
well known that <span class="math inline">\(\sqrt{n}\left(\hat{\xi}_{p}
- \xi_{p}\right)\)</span> is approximately normal with mean zero and
variance <span class="math display">\[\begin{equation}\label{eq:1}
\tag{1}
\omega^2 = \frac{p(1-p)}{\{f_{Y}(\xi_p)\}^2}.
\end{equation}\]</span> A more general result is obtained when the <span class="math inline">\(Y_{i}\)</span>’s, <span class="math inline">\(i =
1, \ldots, n\)</span>, are independent but not identically distributed
(<em>nid</em>). The density evaluated at the <span class="math inline">\(p\)</span>th quantile, <span class="math inline">\(f(\xi_p)\)</span>, is called density-quantile
function by <span class="citation">Parzen (1979)</span>. Its reciprocal,
<span class="math inline">\(s(p) \equiv 1/f(\xi_p)\)</span>, is called
sparsity function <span class="citation">(Tukey 1965)</span> or
quantile-density function <span class="citation">(Parzen
1979)</span>.</p>
<p>As mentioned previously, the discontinuities of <span class="math inline">\(F_{Y}\)</span> when <span class="math inline">\(Y\)</span> is discrete represent a mathematical
inconvenience. <span class="citation">Ma, Genton, and Parzen
(2011)</span> derived the asymptotic distribution of the sample
mid-quantiles, that is, the sample quantiles based on the
mid-distribution function (mid-CDF). The latter is defined as <span class="math inline">\(F^{mid}_{Y}(y) = F_{Y}(y) - 0.5p_{Y}(y)\)</span>,
where <span class="math inline">\(p_{Y}(y)\)</span> denotes the
probability mass function <span class="citation">(Parzen 2004)</span>.
In particular, they showed that, as <span class="math inline">\(n\)</span> becomes large, <span class="math inline">\(\sqrt{n}\left(\hat{\xi}^{mid}_{p} -
\xi_{p}\right)\)</span> is approximately normal with mean <span class="math inline">\(0\)</span>. Under <em>iid</em> assumptions, the
expression for the sampling variance is similar to that in (1); see
<span class="citation">Ma, Genton, and Parzen (2011)</span> for
details.</p>
<p>The package <strong>Qtools</strong> provides the functions
<tt>midecdf</tt> and <tt>midquantile</tt>, which return objects of class
<tt>“midecdf”</tt> or <tt>“midquantile”</tt>, respectively, containing:
the values or the probabilities at which mid-cumulative probabilities or
mid-quantiles are calculated (<span class="math inline">\(x\)</span>),
the mid-cumulative probabilities or the mid-quantiles (<span class="math inline">\(y\)</span>), and the functions that linearly
interpolate those coordinates (<span class="math inline">\(fn\)</span>).
An example is shown below using data simulated from a Poisson
distribution.</p>
<pre><code>&gt; library(&quot;Qtools&quot;)
&gt; set.seed(467)
&gt; y &lt;- rpois(1000, 4)
&gt; pmid &lt;- midecdf(y)
&gt; xmid &lt;- midquantile(y, probs = pmid$y)
&gt; pmid

Empirical mid-ECDF
Call:
midecdf(x = y)

&gt; xmid

Empirical mid-ECDF
Call:
midquantile(x = y, probs = pmid$y)</code></pre>
<p>A confidence interval for sample mid-quantiles can be obtained using
<tt>confint.midquantile</tt>. This function is applied to the output of
<tt>midquantile</tt> and returns an object of class
<tt>“data.frame”</tt> containing sample mid-quantiles, lower and upper
bounds of the confidence intervals of a given level (<span class="math inline">\(95\%\)</span> by default), along with standard
errors as an attribute named <tt>‘stderr’</tt>. This is shown below
using the sample <span class="math inline">\(y\)</span> generated in the
previous example.</p>
<pre><code>&gt; xmid &lt;- midquantile(y, probs = 1:3/4)
&gt; x &lt;- confint(xmid, level = 0.95)
&gt; x

    midquantile    lower    upper
25%    2.540000 2.416462 2.663538
50%    3.822816 3.693724 3.951907
75%    5.254902 5.072858 5.436946

&gt; attr(x, &quot;stderr&quot;)
[1] 0.06295447 0.06578432 0.09276875</code></pre>
<pre><code>&gt; par(mfrow = c(1,2))
&gt; plot(pmid, xlab = &quot;y&quot;, ylab = &quot;CDF&quot;, jumps = TRUE)
&gt; points(pmid$x, pmid$y, pch = 15)
&gt; plot(xmid, xlab = &quot;p&quot;, ylab = &quot;Quantile&quot;, jumps = TRUE)
&gt; points(xmid$x, xmid$y, pch = 15)</code></pre>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">Figure 1. Cumulative distribution (a) and quantile
(b) functions for simulated Poisson data. The ordinary cumulative
distribution function (CDF) and quantile function (QF) are represented
by step-functions (grey lines), with the convention that, at the point
of discontinuity or `jump’, the function takes its value corresponding
to the ordinate of the filled circle as opposed to that of the hollow
circle. The mid-CDF and mid-QF are represented by filled squares, while
the piecewise linear functions (dashed lines) connecting the squares
represent continuous versions of, respectively, the ordinary CDF and
QF.</p>
</div>
<p>Finally, a plot method is available for both <tt>midecdf</tt> and
<tt>midquantile</tt> objects. An illustration is given in Figure 1. The
mid-distribution and mid-quantile functions are discrete and their
values are marked by filled squares. The piecewise linear functions
connecting the filled squares represent continuous versions of the CDF
and QF which interpolate between the steps of, respectively, the
ordinary CDF and quantile functions. Note that the argument
<tt>jumps</tt> is a logical value indicating whether values at jumps
should be marked.</p>
</div>
<div id="lss---location-scale-and-shape-of-a-distribution" class="section level2">
<h2>LSS - Location, scale and shape of a distribution</h2>
<p>Since the cumulative distribution and quantile functions are two
sides of the same coin, the location, scale, and shape (LSS) of a
distribution can be examined using one or the other. Well-known
quantile-based measures of location and scale are the median and
inter-quartile range (IQR), respectively. Similarly, there are also a
number of quantile-based measures for skewness and kurtosis <span class="citation">(Groeneveld and Meeden 1984; Groeneveld 1998; Jones,
Rosco, and Pewsey 2011)</span>.</p>
<p>Define the ‘central’ portion of the distribution as that delimited by
the quantiles <span class="math inline">\(Q(p)\)</span> and <span class="math inline">\(Q(1-p)\)</span>, <span class="math inline">\(0
&lt; p &lt; 0.5\)</span>, and define the ‘tail’ portion as that lying
outside these quantiles. Let <span class="math inline">\(IPR(p) = Q(1-p)
- Q(p)\)</span> denote the inter-quantile range at level <span class="math inline">\(p\)</span>. Building on the results by <span class="citation">Horn (1983)</span> and <span class="citation">Ruppert
(1987)</span>, <span class="citation">Staudte (2014)</span> considered
the following identity: <span class="math display">\[\begin{equation}\label{eq:2}
\tag{2}
\underbrace{\frac{IPR(p)}{IPR(r)}}_\text{kurtosis} =
\underbrace{\frac{IPR(p)}{IPR(q)}}_\text{tail-weight} \, \cdot \,
\underbrace{\frac{IPR(q)}{IPR(r)}}_\text{peakedness},
\end{equation}\]</span> where <span class="math inline">\(0 &lt; p &lt;
q &lt; r &lt; 0.5\)</span>. These quantile-based measures of shape are
sign, location and scale invariant. As compared to moment-based indices,
they are also more robust to outliers and easier to interpret <span class="citation">(Groeneveld 1998; Jones, Rosco, and Pewsey
2011)</span>.</p>
<p>It is easy to verify that a quantile function can be written as <span class="math display">\[\begin{equation}\label{eq:3}
\tag{3}
Q(p) = \underbrace{Q(0.5)}_\text{median}\,\, + \,\,
\frac{1}{2}\underbrace{IPR(0.25)}_\text{IQR} \, \cdot \,
\underbrace{\frac{IPR(p)}{IPR(0.25)}}_\text{shape index} \, \cdot \,
\bigg(\underbrace{\frac{Q(p) + Q(1-p) - 2Q(0.5)}{IPR(p)}}_\text{skewness
index} - 1\bigg).
\end{equation}\]</span> This identity establishes a relationship between
the location (median), scale (IQR) and shape of a distribution. (This
identity appears in <span class="citation">Gilchrist (2000, 74)</span>
with an error of sign. See also <span class="citation">Benjamini and
Krieger (1996, eq.1)</span>.) The quantity <span class="math inline">\(IPR(p)/IPR(0.25)\)</span> in (3) is loosely
defined as the ‘shape index’ <span class="citation">(Gilchrist 2000,
72)</span>, although it can be seen as the tail-weight measure given in
(2) when <span class="math inline">\(p &lt; 0.25\)</span>. For symmetric
distributions, the contribution of the skewness index vanishes. Note
that the skewness index not only is location and scale invariant, but is
also bounded between <span class="math inline">\(-1\)</span> and <span class="math inline">\(1\)</span> (as opposed to the Pearson’s third
standardised moment which can be infinite or even undefined). When this
index is near the bounds <span class="math inline">\(-1\)</span> or
<span class="math inline">\(1\)</span>, then <span class="math inline">\(Q(1-p) \approx Q(0.5)\)</span> or <span class="math inline">\(Q(p) \approx Q(0.5)\)</span>, respectively.</p>
<p>The function <tt>qlss</tt> provides a quantile-based LSS summary with
the indices defined in (3) of either a <em>theoretical</em> or an
<em>empirical</em> distribution. It returns an object of class
<tt>“qlss”</tt>, which is a list containing measures of location
(median), scale (IQR and IPR), and shape (skewness and shape indices)
for each of the probabilities specified in the argument <tt>probs</tt>
(by default, <tt>probs</tt> = 0.1). The quantile-based LSS summary of
the normal distribution is given in the example below for <span class="math inline">\(p =0.1\)</span>. The argument <tt>fun</tt> can
take any quantile function whose probability argument is named (this is
the case for many standard quantile functions in R, e.g. <tt>qt</tt>,
<tt>qchisq</tt>, <tt>qf</tt>, etc.).</p>
<pre><code>&gt; qlss(fun = &quot;qnorm&quot;, probs = 0.1)

call:
qlss.default(fun = &quot;qnorm&quot;, probs = 0.1)

Unconditional Quantile-Based Location, Scale, and Shape

** Location **
Median
[1] 0
** Scale **
Inter-quartile range (IQR)
[1] 1.34898
Inter-quantile range (IPR)
     0.1
2.563103
** Shape **
Skewness index
0.1
  0
Shape index
     0.1
1.900031</code></pre>
<p>An empirical example is now illustrated using the <tt>faithful</tt>
data set, which contains <span class="math inline">\(272\)</span>
observations on waiting time (minutes) between eruptions and the
duration (minutes) of the eruption for the Old Faithful geyser in
Yellowstone National Park, Wyoming, USA. Summary statistics are given in
Table 1.</p>
<table>
<tr>
<td>
</td>
<td>
Minimum
</td>
<td>
Q1
</td>
<td>
Q2
</td>
<td>
Q3
</td>
<td>
Maximum
</td>
</tr>
<tr>
<td>
Wating time
</td>
<td>
43.0
</td>
<td>
58.0
</td>
<td>
76.0
</td>
<td>
82.0
</td>
<td>
96.0
</td>
</tr>
<td>
Duration
</td>
<td>
1.6
</td>
<td>
2.2
</td>
<td>
4.0
</td>
<td>
4.5
</td>
<td>
5.1
</td>
Table 1: Minimum, maximum and three quartiles (Q1, Q2, Q3) for waiting
time and duration in the Old Faithful Geyser data set.
</table>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">Figure 2. Estimated density (a) and empirical
mid-quantile (b) functions of waiting time between eruptions in the Old
Faithful Geyser data set.</p>
</div>
<p>Suppose the interest is in describing the distribution of waiting
times. The density is plotted in Figure 2, along with the mid-quantile
function. The distribution is bimodal with peaks at around <span class="math inline">\(54\)</span> and <span class="math inline">\(80\)</span> minutes. Note that the arguments of
the base function <tt>quantile</tt>, including the argument
<tt>type</tt>, can be passed on to <tt>qlss</tt>.</p>
<pre><code>&gt; y &lt;- faithful$waiting
&gt; par(mfrow = c(1,2))
&gt; plot(density(y))
&gt; plot(midquantile(y, probs = p), jumps = FALSE)
&gt; qlss(y, probs = c(0.05, 0.1, 0.25), type = 7)

call:
qlss.numeric(x = y, probs = c(0.05, 0.1, 0.25), type = 7)

Unconditional Quantile-Based Location, Scale, and Shape

** Location **
Median
[1] 76
** Scale **
Inter-quartile range (IQR)
[1] 24
Inter-quantile range (IPR)
0.05  0.1 0.25
  41   35   24
** Shape **
Skewness index
      0.05        0.1       0.25
-0.3658537 -0.4285714 -0.5000000
Shape index
    0.05      0.1     0.25
1.708333 1.458333 1.000000</code></pre>
<p>At <span class="math inline">\(p = 0.1\)</span>, the skewness index
is approximately <span class="math inline">\(-0.43\)</span>, which
denotes a rather strong left asymmetry. As for the shape index, which is
equal to <span class="math inline">\(1.46\)</span>, one could say that
the tails of this distribution weigh less than those of a normal
distribution (<span class="math inline">\(1.90\)</span>), though of
course a comparison between unimodal and bimodal distributions is not
meaningful.</p>
</div>
</div>
<div id="conditional-quantiles" class="section level1">
<h1>Conditional quantiles</h1>
<div id="linear-models" class="section level2">
<h2>Linear models</h2>
<p>In general, the <span class="math inline">\(p\)</span>th linear QR
model is of the form <span class="math display">\[\begin{equation}\label{eq:4}
\tag{4}
Q_{Y|X}(p) = \mathbf{x}^{\top}\boldsymbol \beta(p)
\end{equation}\]</span> where <span class="math inline">\(\mathbf{x}\)</span> is a <span class="math inline">\(k\)</span>-dimensional vector of covariates
(including <span class="math inline">\(1\)</span> as first element) and
<span class="math inline">\(\boldsymbol \beta(p) = [\beta_{0}(p),
\beta_{1}(p),\)</span> <span class="math inline">\(\ldots,
\beta_{k-1}(p)]^{\top}\)</span> is a vector of coefficients. The
‘slopes’ <span class="math inline">\(\beta_{j}(p)\)</span>, <span class="math inline">\(j = 1,\ldots, k-1\)</span>, have the usual
interpretation of partial derivatives. For example, in case of the
simple model <span class="math inline">\(Q_{Y|X}(p) = \beta_{0}(p) +
\beta_{1}(p)x\)</span>, one obtains <span class="math display">\[
\frac{\partial Q_{Y|X}(p)}{\partial x} =  \beta_{1}(p).\\
\]</span> If <span class="math inline">\(x\)</span> is a dummy variable,
then <span class="math inline">\(\beta_{1}(p) = Q_{Y|X = 1}(p) -
Q_{Y|X=0}(p)\)</span>, i.e. the so-called ‘quantile treatment effect’
<span class="citation">(Doksum 1974; Lehmann 1975; Koenker and Xiao
2002)</span>. Estimation can be carried out using LP algorithms which,
given a sample <span class="math inline">\((\mathbf{x}_{i},y_{i})\)</span>, <span class="math inline">\(i=1,\dots,n\)</span>, solve <span class="math display">\[
\min_{b \in \mathbb{R}^{k}} \sum_{i=1}^{n} \kappa_{p}\left(y_{i} -
\mathbf{x}_{i}^{\top}\mathbf{b}\right),
\]</span> where <span class="math inline">\(\kappa_{p}(u) = u(p - I(u
&lt; 0))\)</span>, <span class="math inline">\(0 &lt; p &lt; 1\)</span>,
is the check loss function. Large-<span class="math inline">\(n\)</span>
approximation of standard errors can be obtained from the sampling
distribution of the linear quantile estimators <span class="citation">(Koenker and Bassett 1978)</span>.</p>
<div class="figure">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAEgCAMAAABrWDzDAAAApVBMVEUAAAAAACsAAFUAKysAK1UAK4AAVYAAVaoAv8QrAAArACsrAFUrK1UrK4ArVaorgIArgKorgNRVAABVACtVAFVVKwBVKytVK4BVVVVVVapVqv+AKwCAKyuAK1WAVQCAgCuAgFWAgICAqoCA1NSA1P+qVQCqVSuqVVWq1ICq/6qq//+zs7PUgCvU1IDU/6rU/9TU///4dm3/qlX/1ID//6r//9T////aBt3RAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAXSUlEQVR4nO2di2LbNpaG5W6zZpq2u3bS6ayc7mxm7JlpotmtJBvv/2grkLgckAAJ4OAqnb+pbJEUL/CncwMI7hiJhNCu9gmQ+hYBREKJACKhRACRUCKASCgRQCSUCCASSgQQCSUCiIQSAURCiQAioUQAkVAigEgoEUAklAggEkoEEAklAoiEUtsAHR7EL+ef/qh6Io3q0j4ve/5LvfZpGiDQLAolkhZvnwmgeu3TNEC8cc7vd7vLj9dPX2ufTXvi7fPy57rt0zJAvFFePz6z84evTH7TSFojNC/v/qjaPi0DJD3Y2FDkwxYa22e0Qvt67dMyQKd3HKCX3e47AsimsX3+/kwAucS/Ya+P+8mFEUALSQv09kQAWcVdF4fn/MMzxUAWTTHQfd0YsWWAJtO8233/y56yMJtEFnb3TFmYXVQHWlcL7dM0QFSJ3lAD7dM2QKTmRQCRUCKASCgRQCSUCCASSgQQCSUCiIQSAURCiQAioUQAkVAigNKKj8DdTSOYbkOJAdql0Jcke9lQ2uuWGofmMDkWLlP7FJHvFacGKMVOvqTYyYYyASRHVbhGV3Rj8LsGqIRqWaA8h00vAsilYRj4j1wn+vo4OgBXDNR++wgRQA4N4v9KJ9p8+0h1DVDGGGiQrwTQugggu0oBNAuiVW7zjeuyIPHPb+nle6UEUFGlP+xxFGIHw4WWKS6EIgvk0DXFQCM6YfZioW+D/bMEENAAv2CZs7ANpTosh+YYj43S0vQIdQ1QYkmjY6hzgLj5we9jxXYRQEoDeNXKVYl+FNGyoxCU7LBYfHjcs+b5bgmgwWGHxfKiALG3p9U7/FIdFm9+XL5LqGuAwmIgq4cCy8sCNE5o5FaiwyZwXwSQkJ0PuPzqYqBL+IyOnzf4uWWAlp7L5uN6Bii/A7tlgNY9l1LPACVwYJu6HYBmHmrDcyl1C1CK+o9H6TEbQBtDNitlYdpJbXgupW4BKmJ/8gHU5oApYGw2PJfSDQPk6r0wlAugJodsGtCsey6lbgHKn8GP6toChfaFmW4LOLTBfAt1wwD58JMvBioxZDMeoGGKfAYmM3n+ZrC1WacApehBrQtQid0F98aDpEsCM7D5vwwnGi70YQsZoNIAhd9OtCZ/gKR3UsVD4bCWAM39WKcAlUnBWE6AXkZOXJMSlwVoHjBP3stlgQyCbhUg39Fn2QAap27e8+mtk+wOJUsvxmoMBAnqE6BiBihvGn/+6Y8m0ngQPBsuTL4DmpUbbxSgb14loFHZ0vjPz5cc/r6NQqICSAfRs5KiscJIx7oECG2A/AJorqxp/Ls/TneOQS9VYqB5/9fA2Bwo4c10E/YHEO8EQw7j8OfnCtN4azlwWmi4MuXAmAGQSM6yA3R+v7s/ZKqTYQ1QAD/XB9BaD4VZSJx8lcUClQCIu/jDvfvRA5jDFnRg1wfQeh8pMENm1m7YpxIxEE8u+AMsciQZ+HH0AQ7wZgASTkxlWMCpjQn9LCFLe6JLZbRA5VJ4rq4BssgFkHRUsPaz3HBufljWGOghTwxEAKFkj4EkLovsa77VokesuyysVCeYUBRAp9VeirTHDZasBpoLQeF5kH1e2qnpihABlB+g027snnh7wiCUtw60sC6CFeDJZPwjIiD5sdIAuaZ3qQZQQBF6VDhAr7+qsO8f8XPUZgXIiG8G09joKEgbokGWfyyjgjqzQAmG0gcZoL5jIB+ARGkZgAJK0nChrSMs1YmGK/qwZUNoVAyEmiO7FEADQEjVDnUtyLQ/elXiE7Uo110rPQD0+oh/9Hh6gKDlAE5LMASXGOGz2RW/7AjJVQfKNWa8C4ASPHo8+d/FiJu1p1I9o4AfsQFbsMNAgJTtRCdlu2ulZD8YV5QLe8E/ezz138WMm6dXUVtmw8yPqYzMAAjm+RlPVCiXBSraD8YV58IaiYGAVgDSgAizBLAxjBCIh/KdqFSmu1ZKG6CrycJcABldF2oJM+EBFcZSFmhLBFCJ3cEg2oyBmIyd9a/jcvnOSN9BFxksEyU80XBFHrZoR/yoiELip999XFiJyRWcWRiwMOM7WDRcpF7z33ouJJbOwTKOia5+a7OKi5Ux0uM2ZsGz7s8YhrkPI4DWlauQWGRyhTWAQBavrJD0WDBmVvm96i/rOAYq3JHKFZWFrU4POan69C6ggji9V/QssjCzo6PjO1MTzIlYBiCfQmLt52FtWCCmHJz0Y7YUrMSJ2lXJAgXzE+fCDu0VEpdaj4GMorS+F2NRiO4KoAoeLBKg6EJiqckV5lmYWfex5mIMYATPOMWJhuuqAfKJgbLe9yS1MaBM97AP+p10Yub/sFaU4UTDVQmgcOWKgXLe96TkM5xDUgRuvGCqkqh9mfRyPcdANfjJFgPlvO9JyXZbzzAzJdKPzauGLp+W5UTDFXHYJI91ClauztRKFgjGwYYFAg5Mpl2yCKSLi8sQuieACs2qOVO2vrB89z2tSJKziIF0Ug9LiYAfw43lP9FNXTFAr/+lltUeVL+QMj3abTGmei6YNj5z/6Wo0o4v64luKvyweH6+rT4YzKGub+tZaJFHaYCUvwKs6DIig2+Nrv0bAijGAPV9Y6ErBoILFB/aX5k5/GDGQHoPQ7oTDVfoYVM82akcQAmUNQubLXDIWl1UlWu5o3x3ZewvNnzn6CoMP2yVHJ5dH0AWDcBP6W4MYHdUbUi9AEuWcUw0n4c0VZZai58bAEh1qRrhjkHMnCJYDch3V8Y4jWSqOhkBFKNNgJRbAj9BFsag4wIuDPaK5XJhF/NzehjnIbWqBkAxIVDfAG3J7KcAQzlgp4bYEjg4I4rOdqLTROwOfkIPm8QAlQPoEv29+1+fHtUEx0UIVA8XMRCTrBhFx8FcWOpELQo7bJJejCh+ogB6e3q4xH6usYaJj+uvZQKmui6k3TF+Byv1trIZ1c66AKieB4vtjV+Zgz7xcddk3pXB5m0wsyowuxJ1aqaYGcC/9CfqVqL5gfoCaLJAh/oWaH5f2JIgENfI1brLVA/oYKC3NceJhivssAn48X24ylyxMZC7BJb4uGtyAaT8D8ys1Ds1NGgA67Uzy3Gi4SoOUKy6zsIcAAFnNpivs8553X2x9H9JT9SipDde9gZQkxNMKQYMZzbr2jKHB+m6EPwI8kT9YsO0tz3VC4HyjYlOdVx/mRwMs6XAuxmjymShiKUEyNVBYW4Ff6IOW5GffPeFpTpuuBw0gAKP6sKQUXV5gJJaoN4Aav2+MEdAo32cpkjmZAljID+Akt542R9A5WbnOB5XWsd5VwYIluUvIMkCFUO10JaABZ2okiCjXIyYYGZfVtiFlbs3/sjWvl8OgHRh0MzKBrDeu8U6SOMr5mD5YqA0QeIRvFpkB0hVCcUb1dllEOT7jSOA1pUrBkpjgRIBBEZuiE1cDiv2RA2N3hvlwK4cIK9JNpMEiWkAGlQUxPzBkQoHaHpO7Pl9sTHjKToywh6QAdR4JXo9BnJoFgPBik84QcHXPQ40ZO7BqskPW28sEFdhgIJ7m1ezMJcvMjMr6MIKALQV/SU/bM0kPurGQq9JNl8f1+OkNDx6RcOq31T1ooaIAFpXLgv0+ukvqzeOJewLCyCoRAxEAG1uODXNegPxtS8rRioDQG7rYoyfD1T7hcSqSViMC5MNtDogSED26GrG9ABtubOg8qFW83WguvxkLySij7umL46RP3aFlA+1bgCg2MGIo5pM4zdSL6UvwG15GJgIBxZ13S/3+GeqFbVA8RFQmwBFF39wTWFX+HVPg8W30tBkhyWA5tooP7sU56E2FR5EfyxaSKzMzxUBJIemRjkqtxpP41NM61IcIJmHYfLUJACZfWHLXvcUCu/K2OhGhjp/cDXhdVug8ZGXh3vMvalJYqDFoPoMoVC45T3/4NGZulUtKgkQSphC4u8II+0+7nEUfGv5dVKbAE1wbJnn18fLFngLVJufKIDenkYL9O5fiDDRedyZ+QFvl4apUYA89fr47l8tAIRrrLggmk9Nco8qdbiOOwuAwFtLaNRkDBSg83unnSoHUPxQoFG1s7C5WzIxEWtdAM002Pq7sElZ45XoTi0QXmJ3C7dkYHIc//MGyFYLQhskAmhdUQAlu7VZQ6Es0TzoOR6tMZC1t2MZAOFDoswAIad3qTuUgyuuDoTr59G7UwBBbBQa43J7FjZtPx8T3SFAyMNWT8Ky9cb77U4CZHdP0n8tW0lsTwD1CdBUSExyXOGltCWCnml8cwQb6DXT6+KujI5ioCR37tZ5wpOhbLf1eO5ugkMmW2aYI3laFoBcAFlyrkazsIR37iKFrHnUTuNlinVceDKwHCwFH1rGQDmUCaCUd+7i1CpA3iZa8LFARS23Bki+Y87QatoC1TdA2W7r8W8gV7HZyNDqhYu5YqCEd+6iVB4gPwWYaFd3l1FCrJZuNJ2FdQqQz209ISYa9L+Pv4j/dfLl8lcdx0BJDls/ic93W0+YiV4YG0nR+jkRQPVVt5AoNCtIj/+JMvTqTm4boBQzk6Hu6BlVOI239PUclccSzkwANBtYZtNtA9RCEp8vC/N+pKPqST0uLdAWQQQQWhUA8pPvIx1VuVBYIqa7N46gjFhP1w0QfuhdxjTe65GOipajdmVGFkYAudSEAYoDyGeaX89HOsohG4IZpvvF9L+qIoDWFZWFfXy+cHFwPa1RyPORjjLYYTJth13zG6102zFQ7a/WpMg0fvqX5Lgq/dKRjwiMKAtbVb8AXYKbyz/3PU1hu4O98UfmYXe0bhqgNjxYXAx0Yee026FGlZl9YcoAgRDIQwQQUrUASqBZXxioJ06LVj6qHdstA5SiDD3gJ2aI6wvDj6m39IX5WqDCffOtAtRGFSh2TDT6kanz46p69GYMVHp0UKsANeLB4l3YKe0spEdDKzkYMFZFlHFQ/Z1HodWpNnKwWID4WI3EcwDqIPoo31lbCVqpjmMg3tXDJ6m4RYAu9NyhH5q6sEAMArRWhwZxUscATeC83N8gQCkeuWum8XOp8WTaLkHpTK1jgMSIzcO/OappW4dtJISOskB8lAaqBmTu7mjpCzuCMWVs2VpXAJCcxfUQOUNZzwBxHbBpGOwLAwSpoR2MyaFl40azTwuqegYIddgkU2smKAKxBrKwIxx/OB/XoWrU05aao/6zMNxhmzFAcQCdVrrZQ3cHxv7IuOeoomQ9RrF4AXFxonkUOb1LzwBdkjAkPOZxTcOjRgjZ2SlPUJMWqJUUjFXuC5NRszUJU+PKVGWIzVvuZmMgAmjcnTIuR5W3Kw921PeJuS1QzwBhpndpiJ+aAJkjD+XtPPJXpgmaU6TUMUCoyRVa6QfjygbQ9jdMA2SrJQIHJz6yzLw6BggzvUtL/GS9rYdr5Ru2tEDS9Pj0ynN1DBDCAqUoAiUZCjQq4209xk/b7mAMBPJ4eVchYy14+3yV6NgYqCkDVNMC6RFAbOa+4K3OBWuG7hNt6rC3AVDIN+yojZAKn3WPGKtrh64ToHRqYUw0A91gkh/dI79CUMcxUPxh2+KnNECOUv0iC9PDgwggUylm9kU+X8VQziCae7HN2Tkm6VIQKPgQQDa1FQLlBGhMwM4/e+3OKEaD7Gy9D/UWAWqMn5wAjTO7+BTKdAoPq9EeWRgBFKcuAHq8+9tvX7fnB2KW7jBthxrQFQJU56nWwQ359rS7ZyfPicbNGKh+8q7VGEBtNApQ/TTeKCNCp2X2hNVSUwC1Ma+moQYAOhov4yL5umGIbi8Gwn6dEtPDGgUIlBPZWqMRQMFCPrtoqQYAYtp/qWXuUYhQNwcQnh/sDhZqASA2B8is/xBASliA0vPTAEAMhM9igXqlGMgUEqCUXRhSDQCkJ5gCs0sZoxJrqiWAareFTa0AJDvkx/dqQEcDIoDW1QJAcDwrHM3aRHs1dFcGrgiUPoMf1QRAqutLxT/HjehnUscxUMyYaMwXKnn6LtUGQGoMmZF4XTNAMXdlxAM0DHnMD2sGIDWKVb/1aK+OAQq3QLEx4QWdZLdgWNQKQLpDTL3d3knHAAXflRGJTzbXJdUMQKMCO+F7BijosN+Ox5gY+FtG1yXVFECeoU9RNQFQrPlJcCJbIoA2lBkg1/xA35JoSt65Dcr30/dKCaBbOGy4mrJAFAPVPmy42gIosO+rZ4Aw8wO1pMYAClPHAKHmB2pJBNCGGqpEN6lqAKXQlyR72VDa65batEDdyPeKkzekfYeOw4RsnG8XKbVRid48D/eq+mtSbB67w5sByEsEUPAOCSAoAih4hwQQFAEUvEMCCIoACt4hAQRFAAXvkACCIoCCd0gAQRFAwTskgKAIIBJJiAAioUQAkVAigEgoEUAklAggEkoEEAklAoiEEgFEQokAIqFEAJFQIoBIKBFAJJQIIBJKBBAJJQKIhFJCgM4fprvpDps31o1TEOw9Nz6pDTx2rO8N9dq4gsbze31cPnVWnLBl1dvT7u7Z9qHDeBPj3vaZSwvzqw9aE6V0AJ3k3+tlv7Xp68dndv7h2WtjjuXh3nPHjDfq3n/jCuLnxyES16Q1nbBt1WXN6d0f1g8xxxrewgf7mse9Y02ckgH0cvfXyQK9fX7e2vbEz3xsMI+NmbRtXtuef/xl73kWVTSeH596QdprKXHCllViogbbhyZSLGv4I0nFA5Jtaz4+2/cWofQubLw7fPvrz6/cd+Ppq+Kz7dvnv00uzPMsSms6P/FHNNaIE7asOv/039yF2T40NY1ljbBA1r2Ni+x7i1B6gLhv2v7+vz09+G58fn/37Lvt4UHEQH5nUVzT+fG5O+Z/PXHCllXn9yNXtg9NC2xrphDHsmZ0YXe248QpQxDNtRWBvD4+6Deb4Qq40vVtL+0sg2ivHZeWOD/n1/9lH2gzxmlkbJ+54Hj67qvtM5cg+j8/t2yBRm386fiXSmv776y3WN92Skse/DauIHF+zgDkZW+LgX51Ry0v/Fota4SBcRzIHh3FKT1A/Nzffls9Nc3P9sba1nrsmKk03m/jCuLnx/33PAUSJ2xb9bKfTNdyzeSkLWuEBbKsGaOje+spRCkxQGPSvdvdbUQqU/3Ce2MeQnpty6Y/kPfGFbRWB7JXe/giR+VGOCHLmpNzb5c1fFF7dSDSTYoAIqFEAJFQIoBIKBFAJJQIIBJKBBAJJQKIhBIBREKJACKhRACRUCKASCgRQCSUCCASSgQQCSUCiIQSAURCiQAioUQAkVAigEgoEUAklAggEkoEEAklAoiEEgFEQokAIqFEAJFQIoBIKBFAJJQIIBJKNQHik/06JjI8f/hqn/7o8GBuJX/7KcVUJU2Iz4p14q1yktP3TI1haw9nM3GVaaqqAH34Os3Z51hlW+66eqO1uha/ksOfH8xLcrTH2hxjhZqqOkD8QsXUVOcff/nu6zgHOZ9S6Z8fvoqplfg0pXr257fP/7PbPZz4THb8M2KdmAv3CsQnI/v8V/7yLCZkP3/4fWoPdbGPu+//NE0fxReDFpGTUbFiTVUfID5/pADo/X6ag1yZ7JcHPvXb+f3DNJvkeO1vT/eXhr2XW8l1zc2HGCs+geGv//cbn8XQaAxwsbxZxunXpsWgRfgqMSlyoaaqD9DlmyYBEgb5cu3TO94Imi82mWX+zeT/TyvUuqvxYbw9fubztf48vlWNoS92ZOMzAEi3iJx3vFxT1QcIWKDx/Qt/ZIRuMM0XEzNRXjlA7LA/7NnpYbwgszFkOwk2bADx6crv1JSkNwEQ91EaIB5Tq9a6SQt0yb7+fvFcP19ejMbws0CfYLJ1EwDxRhqnnv1OXeH5B3m9IgZSAMmms7TK1cRA7PVP49/+x1ljgIudx0C6RUSLsXJN1UYd6LDb/cenyYVdfv3+l/3bE8zCFEBTamFrlevJwsbQ93Kl/GVqjDFOHrMwebGPu38XM0RPWZgG6LJKzG5cqKk6q0TfQB3IT2sVILHF9deBYuS4+iuqRG/r7clrEvUyTdUbQKTGRACRUCKASCj9P4wPZP0zUTPhAAAAAElFTkSuQmCC" alt />
<p class="caption">Figure 3. (a) Waiting times between eruptions against
durations of eruptions (dashed vertical line drawn at <span class="math inline">\(3\)</span> minutes) in the Old Faithful Geyser
data set. (b) Mid-CDF of waiting time by duration of eruption (solid
line, shorter than 3 minutes; dashed line, longer than 3 minutes).</p>
</div>
<p>Waiting times between eruptions are plotted against the durations of
the eruptions in Figure 3. Two clusters of observations can be defined
for durations below and above 3 minutes <span class="citation">(see also
Azzalini and Bowman 1990)</span>. The distribution shows a strong
bimodality as already illustrated in Figure 2. A dummy variable for
durations equal to or longer than <span class="math inline">\(3\)</span>
minutes is created to define the two distributions and included as
covariate <span class="math inline">\(X\)</span> in a model as the one
specified in (4). The latter is then fitted to the Old Faithful Geyser
data using the function <tt>rq</tt> in the package
<strong>quantreg</strong> for <span class="math inline">\(p \in \{0.1,
0.25, 0.5, 0.75, 0.9\}\)</span>.</p>
<pre><code>&gt; require(&quot;quantreg&quot;)
&gt; y &lt;- faithful$waiting
&gt; x &lt;- as.numeric(faithful$eruptions &gt;= 3)
&gt; fit &lt;- rq(formula = y ~ x, tau = c(0.1, 0.25, 0.5, 0.75, 0.9))
&gt; fit


Call:
rq(formula = y ~ x, tau = c(0.1, 0.25, 0.5, 0.75, 0.9))

Coefficients:
            tau= 0.10 tau= 0.25 tau= 0.50 tau= 0.75 tau= 0.90
(Intercept)        47        50        54        59        63
x                  26        26        26        25        25

Degrees of freedom: 272 total; 270 residual</code></pre>
<p>From the output above, it is quite evident that the distribution of
waiting times is shifted by an approximately constant amount at all
considered values of <span class="math inline">\(p\)</span>. The
location-shift hypothesis can be tested by using the Khmaladze test. The
null hypothesis is that two distributions, say <span class="math inline">\(F_{0}\)</span> and <span class="math inline">\(F_{1}\)</span>, differ by a pure location shift
<span class="citation">(Koenker and Xiao 2002)</span>, that is <span class="math display">\[
H_{0}: \, F^{-1}_{1}(p) = F^{-1}_{0}(p) + \delta_{0},
\]</span> where <span class="math inline">\(\delta_{0}\)</span> is the
quantile treatment effect, constant over <span class="math inline">\(p\)</span>. The location–scale-shift specification
of the test considers <span class="math display">\[
H_{0}: \, F^{-1}_{1}(p) = \delta_{1}F^{-1}_{0}(p) + \delta_{0}.
\]</span> The alternative hypothesis is that the model is more complex
than the one specified in the null hypothesis. The Khmaladze test is
implemented in <strong>quantreg</strong> (see
<tt>?quantreg::KhmaladzeTest</tt> for further details). The critical
values of the test and corresponding significance levels <span class="citation">(Koenker 2005)</span> are not readily available in the
same package. These have been hardcoded in the <strong>Qtools</strong>
function <tt>KhmaladzeFormat</tt> which can be applied to
<tt>“KhmaladzeTest”</tt> objects. For the Old Faithful Geyser data, the
result of the test is not statistically significant at the <span class="math inline">\(10\%\)</span> level.</p>
<pre><code>&gt; kt &lt;- KhmaladzeTest(formula = y ~ x, taus = seq(.05, .95, by = .01),
&gt; KhmaladzeFormat(kt, 0.05)

Khmaladze test for the location-shift hypothesis
Joint test is not significant at 10% level
Test(s) for individual slopes:
 not significant at 10% level</code></pre>
</div>
<div id="goodness-of-fit" class="section level2">
<h2>Goodness of fit</h2>
<p>Distribution-free quantile regression does not require introducing an
assumption on the functional form of the error distribution <span class="citation">(Koenker and Bassett 1978)</span>, but only weaker
quantile restrictions <span class="citation">(Powell 1994)</span>.
Comparatively, the linear specification of the conditional quantile
function in Equation 4 is a much stronger assumption and thus plays an
important role for inferential purposes.</p>
<p>The problem of assessing the goodness of fit (GOF) is rather
neglected in applications of QR. Although some approaches to GOF have
been proposed <span class="citation">(Zheng 1998; Koenker and Machado
1999; X. M. He and Zhu 2003; Khmaladze and Koul 2004)</span>, there is
currently a shortage of software code available to users. The function
<tt>GOFTest</tt> implements a test based on the cusum process of the
gradient vector <span class="citation">(X. M. He and Zhu 2003)</span>.
Briefly, the test statistic is given by the largest eigenvalue of <span class="math display">\[
n^{-1}\sum_{i}^{n}
\mathbf{R}_{n}(\mathbf{x}_{i})\mathbf{R}^{\top}_{n}(\mathbf{x}_{i})
\]</span> where <span class="math inline">\(\mathbf{R}_{n}(\mathbf{t}) =
n^{-1/2} \sum_{j=1}^{n} \psi_{p}(r_{j})\mathbf{x}_{j} I(\mathbf{x}_{j}
\leq \mathbf{t})\)</span> is the residual cusum (RC) process and <span class="math inline">\(\psi_{p}(r_{j})\)</span> is the derivative of the
loss function <span class="math inline">\(\kappa_{p}\)</span> calculated
for residual <span class="math inline">\(r_{j} = y_{j} -
\mathbf{x}_{j}^{\top}\boldsymbol \beta(p)\)</span>. The sampling
distribution of this test statistic is non-normal <span class="citation">(X. M. He and Zhu 2003)</span> and a resampling
approach is used to obtain the <span class="math inline">\(p\)</span>-value under the null hypothesis.</p>
<p>An example is provided further below using the New York Air Quality
data set, which contains <span class="math inline">\(111\)</span>
complete observations on daily mean ozone (parts per billion – ppb) and
solar radiation (Langleys – Ly). For simplicity, wind speed and maximum
daily temperature, also included in the data set, are not analysed
here.</p>
<p>Suppose that the model of interest is <span class="math display">\[\begin{equation}\label{eq:5}
\tag{5}
Q_{\text{ozone}}(p) = \beta_{0}(p) + \beta_{1}(p) \cdot \text{Solar.R}.
\end{equation}\]</span> Three conditional quantiles (<span class="math inline">\(p \in \{0.1,0.5,0.9\}\)</span>) are estimated and
plotted using the following code:</p>
<pre><code>&gt; dd &lt;- airquality[complete.cases(airquality), ]
&gt; dd &lt;- dd[order(dd$Solar.R), ]
&gt; fit.rq &lt;- rq(Ozone ~ Solar.R, tau = c(.1, .5, .9), data = dd)
&gt; x &lt;- seq(min(dd$Solar.R), max(dd$Solar.R), length = 200)
&gt; yhat &lt;- predict(fit.rq, newdata = data.frame(Solar.R = x))
&gt; plot(Ozone ~ Solar.R, data = dd)
&gt; apply(yhat, 2, function(y,x) lines(x,y), x = x)</code></pre>
<pre><code>## Warning: package &#39;quantreg&#39; was built under R version 4.1.3</code></pre>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">Figure 4. Predicted 10th (solid line), 50th (dashed
line), and 90th (dot-dashed line) centiles of ozone conditional on solar
radiation in the New York Air Quality data set.</p>
</div>
<p>As a function of solar radiation, the median of the ozone daily
averages increases by <span class="math inline">\(0.09\)</span> ppb for
each Ly increase in solar radiation (Figure 4). The 90th centile of
conditional ozone shows a steeper slope at <span class="math inline">\(0.39\)</span> ppb/Ly, about nine times larger than
the slope of the conditional <span class="math inline">\(10\)</span>th
centile at <span class="math inline">\(0.04\)</span> ppb/Ly.</p>
<p>The RC test applied to the the object <tt>fit.rq</tt> provides
evidence of lack of fit for all quantiles considered, particularly for
<span class="math inline">\(p = 0.1\)</span> and <span class="math inline">\(p = 0.5\)</span>. Therefore the straight-line
model in Equation 5 for these three conditional quantiles does not seem
to be appropriate. The New York Air Quality data set will be analysed
again in the next section, where a transformation-based approach to
nonlinear modelling is discussed.</p>
<pre><code>&gt; gof.rq &lt;- GOFTest(fit.rq, alpha = 0.05, B = 1000, seed = 987)
&gt; gof.rq

Goodness-of-fit test for quantile regression based on the cusum process
Quantile 0.1: Test statistic = 0.1057; p-value = 0.001
Quantile 0.5: Test statistic = 0.2191; p-value = 0
Quantile 0.9: Test statistic = 0.0457; p-value = 0.018</code></pre>
</div>
<div id="transformation-models" class="section level2">
<h2>Transformation models</h2>
<p>Complex dynamics may result in nonlinear effects in the relationship
between the covariates and the response variable. For instance, in
kinesiology, pharmacokinetics, and enzyme kinetics, the study of the
dynamics of an agent in a system involves the estimation of nonlinear
models; phenomena like human growth, certain disease mechanisms and the
effects of harmful environmental substances such as lead and mercury,
may show strong nonlinearities over time. In this section, the linear
model is abandoned in favor of a more general model of the type <span class="math display">\[\begin{equation}\label{eq:6}
\tag{6}
Q_{Y|X}(p) = g\left\{\mathbf{x}^{\top}\boldsymbol \beta(p)\right\},
\end{equation}\]</span> for some real-valued function <span class="math inline">\(g\)</span>. If <span class="math inline">\(g\)</span> is nonlinear, the alternative
approaches to conditional quantile modelling are</p>
<ol style="list-style-type: decimal">
<li>nonlinear parametric models—this approach may provide a model with
substantive interpretability, possibly parsimonious (in general more
parsimonious than polynomials), and valid beyond the observed range of
the data. A nonlinear model depends on either prior knowledge of the
phenomenon or the introduction of new, strong theory to explain the
observed relationship with potential predictive power. Estimation may
present challenges;</li>
<li>polynomial models and smoothing splines—this approach goes under the
label of <em>nonparametric regression</em>, in which the complexity of
the model is approximated by a sequence of linear polynomials (a naive
global polynomial trend can be considered to be a special case). A
nonparametric model need not introducing strong assumptions about the
relationship and is essentially data-driven. Estimation is based on
linear approximations and, typically, requires the introduction of a
penalty term to control the degree of smoothing; and</li>
<li>transformation models—a flexible, parsimonious family of parametric
transformations is applied to the response seeking to obtain approximate
linearity on the transformed scale. The data provide information about
the ‘best’ transformation among a family of transformations. Estimation
is facilitated by the application of methods for linear models.</li>
</ol>
<p>The focus of this section is on the third approach. More specifically
the functions available in <strong>Qtools</strong> refer to the methods
for transformation-based QR models developed by <span class="citation">Powell (1991)</span>, <span class="citation">Chamberlain (1994)</span>, <span class="citation">Mu
and He (2007)</span>, <span class="citation">Dehbi, Cortina-Borja, and
Geraci (2016)</span> and <span class="citation">Geraci and Jones
(2015)</span>. Examples of approaches to nonlinear QR based on
parametric models or splines can be found in <span class="citation">Koenker and Park (1996)</span> and <span class="citation">Yu and Jones (1998)</span>, respectively.</p>
<p>The goal of transformation-based QR is to fit the model <span class="math display">\[\begin{equation}\label{eq:7}
\tag{7}
Q_{h\left(Y;\lambda_{p}\right)}(p) = \mathbf{x}^{\top}\boldsymbol
\beta(p).
\end{equation}\]</span> The assumption is that the transformation <span class="math inline">\(h\)</span> is the inverse of <span class="math inline">\(g\)</span>, <span class="math inline">\(h(Y;
\lambda_{p}) \equiv g^{-1}(Y)\)</span>, so that the <span class="math inline">\(p\)</span>th quantile function of the transformed
response variable is linear. (In practice, it is satisfactory to achieve
approximate linearity.) The parameter <span class="math inline">\(\lambda_{p}\)</span> is a low-dimensional
parameter that gives some flexibility to the shape of the transformation
and is estimated from the data. In general, the interest is on
predicting <span class="math inline">\(Q_{Y|X}(p)\)</span> and
estimating the effects of the covariates on <span class="math inline">\(Q_{Y|X}(p)\)</span>. If <span class="math inline">\(h\)</span> is a non-decreasing function on <span class="math inline">\(\mathbb{R}\)</span> (as is the case for all
transformations considered here), predictions can be easily obtained
from (7) by virtue of the equivariance property of quantiles, <span class="math display">\[\begin{equation}\label{eq:8}
\tag{8}
Q_{Y|X}(p) = h^{-1}\left\{\mathbf{x}^{\top}\boldsymbol \beta(p);
\lambda_{p}\right\}.
\end{equation}\]</span> The marginal effect of the <span class="math inline">\(j\)</span>th covariate <span class="math inline">\(x_{j}\)</span> can be obtained by differentiating
the quantile function <span class="math inline">\(Q_{Y|X}(p)\)</span>
with respect to <span class="math inline">\(x_{j}\)</span>. This can be
written as the derivative of the composition <span class="math inline">\(Q \circ \eta\)</span>, i.e.<br />
<span class="math display">\[\begin{equation}\label{eq:9}
\tag{9}
\frac{\partial Q(p)}{\partial x_{j}} = \frac{\partial Q(p)}{\partial
\eta(p)} \cdot \frac{\partial \eta(p)}{\partial x_{j}},
\end{equation}\]</span> <span class="math inline">\(\eta(p) =
\mathbf{x}^{\top}\boldsymbol \beta(p)\)</span>. Once the estimates <span class="math inline">\(\hat{\boldsymbol{\beta}}(p)\)</span> and <span class="math inline">\(\hat{\lambda}_{p}\)</span> are obtained, these can
be plugged in Equations 8 and 9.</p>
<p>The package <strong>Qtools</strong> provides several transformation
families, namely the Box–Cox <span class="citation">(Box and Cox
1964)</span>, Aranda-Ordaz <span class="citation">(Aranda-Ordaz
1981)</span>, and Jones <span class="citation">(Jones 2007; Geraci and
Jones 2015)</span> transformations. A distinction between these families
is made in terms of the support of the response variable to which the
transformation is applied and the number of transformation parameters.
The Box–Cox model is a one-parameter family of transformations which
applies to singly bounded variables, <span class="math inline">\(y &gt;
0\)</span>. The Aranda-Ordaz symmetric and asymmetric transformations
too have one parameter and are used when responses are bounded on the
unit interval, <span class="math inline">\(0 &lt; y &lt; 1\)</span>
(doubly bounded). <span class="citation">Geraci and Jones (2015)</span>
developed two families of transformations which can be applied to either
singly or doubly bounded responses:</p>
<ul>
<li>Proposal I transformations – this family has one parameter and it
comes in both symmetric and asymmetric forms;</li>
<li>Proposal II transformations – this family has two parameters, with
one parameter modelling the symmetry (or lack thereof) of the
transformation.</li>
</ul>
<p>Originally, <span class="citation">Box and Cox (1964)</span> proposed
using power transformations to address lack of linearity,
homoscedasticity and normality of the residuals in mean regression
modelling. () reported that ``seldom does this transformation fulfil the
basic assumptions of linearity, normality and homoscedasticity
simultaneously as originally suggested by Box &amp; Cox (1964). The
Box-Cox transformation has found more practical utility in the empirical
determination of functional relationships in a variety of fields,
especially in econometrics’’.</p>
<p>Indeed, the practical utility of power transformations has been long
recognised in QR modelling <span class="citation">(Powell 1991;
Buchinsky 1995; Chamberlain 1994; Mu and He 2007)</span>. Model 7 is the
Box–Cox QR model if <span class="math display">\[\begin{equation}\label{eq:10}
\tag{10}
h_{BC}\left(Y;\lambda_{p}\right) =
\begin{cases}
\dfrac{Y^{\lambda_{p}} - 1}{\lambda_{p}} &amp; \text{if $\lambda_{p}
\neq 0$}\\[.5cm]
\log Y &amp; \text{if $\lambda_{p} = 0$}.
\end{cases}
\end{equation}\]</span> Note that when <span class="math inline">\(\lambda_{p} \neq 0\)</span>, the range of this
transformation is not <span class="math inline">\(\mathbb{R}\)</span>
but the singly bounded interval <span class="math inline">\((-1/\lambda_{p},\infty)\)</span>. This implies
that the inversion in (8) is defined only for <span class="math inline">\(\lambda_{p} \mathbf{x}^{\top}\boldsymbol \beta(p)
+ 1 &gt; 0\)</span>.</p>
<p>The ‘symmetric’ Aranda-Ordaz transformation is given by <span class="math display">\[\begin{equation}\label{eq:11}
\tag{11}
h_{AOs}\left(Y;\lambda_{p}\right) =
\begin{cases}
\dfrac{2}{\lambda_{p}} \quad \dfrac{Y^{\lambda_{p}} -
\left(1-Y\right)^{\lambda_{p}}}{Y^{\lambda_{p}}  +
\left(1-Y\right)^{\lambda_{p}}}&amp; \text{if  $\lambda_{p} \neq
0$},\\[.5cm]
\log\left(\dfrac{Y}{1-Y}\right) &amp; \text{if $\lambda_{p} =
0$}.
\end{cases}
\end{equation}\]</span> (The symmetry here is that <span class="math inline">\(h_{AOs}(\theta;\lambda_p) =
-h_{AOs}(1-\theta;\lambda_p)=h_{AOs}(\theta;-\lambda_p)\)</span>.) There
is a range problem with this transformation too since, for all <span class="math inline">\(\lambda_p \neq 0\)</span>, the range of <span class="math inline">\(h_{AOs}\)</span> is not <span class="math inline">\(\mathbb{R}\)</span>, but <span class="math inline">\((-2/|\lambda_{p}|, 2/|\lambda_{p}|)\)</span>. The
‘asymmetric’ Aranda-Ordaz transformation is given by <span class="math display">\[\begin{equation}\label{eq:12}
\tag{12}
h_{AOa}\left(Y;\lambda_{p}\right) =
\begin{cases}
\log \left\{\dfrac{\left(1-Y\right)^{-\lambda_{p}} -
1}{\lambda_{p}} \right\}&amp; \text{if $\lambda_{p} \neq 0$},\\[.5cm]
\log \left\{-\log\left(1 - Y\right)\right\} &amp; \text{if
$\lambda_{p} = 0$}.
\end{cases}
\end{equation}\]</span> For <span class="math inline">\(\lambda_{p} =
0\)</span>, this is equivalent to the complementary log-log. The
asymmetric Aranda-Ordaz transformation does have range <span class="math inline">\(\mathbb{R}\)</span>. Note that <span class="math inline">\(h_{AOa}(Y;1) = \log (Y/(1-Y))\)</span>, i.e. the
transformation is symmetric.</p>
<p>To overcome range problems, which give rise to computational
difficulties, <span class="citation">Geraci and Jones (2015)</span>
proposed to use instead one-parameter transformations with range <span class="math inline">\(\mathbb{R}\)</span>. Proposal I is written in
terms of the variable (say) <span class="math inline">\(W\)</span>,
where <span class="math display">\[\begin{equation}\label{eq:13}
\tag{13}
h_I\left(W;\lambda_{p}\right) =
\begin{cases}
\dfrac{1}{2\lambda_{p}}\left(W^{\lambda_{p}} -
\dfrac{1}{W^{\lambda_{p}}}\right)&amp; \text{if $\lambda_{p} \neq
0$}\\[.5cm]
\log W &amp; \text{if $\lambda_{p} = 0$},
\end{cases}
\end{equation}\]</span> which takes on four forms depending on the
relationship of <span class="math inline">\(W\)</span> to <span class="math inline">\(Y\)</span>, as described in Table 2. For each of
domains <span class="math inline">\((0,\infty)\)</span> and <span class="math inline">\((0,1)\)</span>, there are symmetric and asymmetric
forms.</p>
<table>
<tr>
<td>
Support of <span class="math inline">\(Y\)</span>
</td>
<td>
Symmetric
</td>
<td>
Asymmetric
</td>
</tr>
<tr>
<td>
<span class="math inline">\((0,\infty)\)</span>
</td>
<td>
<span class="math inline">\(W= Y\)</span>
</td>
<td>
<span class="math inline">\(W= \log(1+Y)\)</span>
</td>
</tr>
<td>
</td>
<td>
<span class="math inline">\(h_{Is}(Y;\lambda_p)\)</span>
</td>
<td>
<span class="math inline">\(h_{Ia}(Y;\lambda_p)\)</span>
</td>
</tr>
<td>
<span class="math inline">\((0,1)\)</span>
</td>
<td>
<span class="math inline">\(W= Y/(1-Y)\)</span>
</td>
<td>
<span class="math inline">\(W= -\log(1-Y)\)</span>
</td>
</tr>
<td>
</td>
<td>
<span class="math inline">\(h_{Is}(Y;\lambda_p)\)</span>
</td>
<td>
<span class="math inline">\(h_{Ia}(Y;\lambda_p)\)</span>
</td>
Table 2: Choices of <span class="math inline">\(W\)</span> and
corresponding notation for transformations based on (13).
</table>
<p>Since the transformation in (13) has range <span class="math inline">\(\mathbb{R}\)</span> for all <span class="math inline">\(\lambda_{p}\)</span>, it admits an explicit
inverse transformation. In addition, in the case of a single covariate,
every estimated quantile that results will be monotone increasing,
decreasing or constant, although different estimated quantiles can have
different shapes from this collection. <span class="citation">Geraci and
Jones (2015)</span> also proposed a transformation that unifies the
symmetric and asymmetric versions of <span class="math inline">\(h_{I}\)</span> into a single two-parameter
transformation, namely <span class="math display">\[\begin{equation}\label{eq:14}
\tag{14}
h_{II}(W;\lambda_p) = h_I(W_{\delta_p};\lambda_p),
\end{equation}\]</span> where <span class="math inline">\(h_I\)</span>
is given in (13) and <span class="math display">\[\begin{equation*}
W_{\delta_{p}} = h_{BC}(1+W;\delta_p) =
\begin{cases}
\dfrac{(1+W)^{\delta_{p}} - 1}{\delta_{p}} &amp; \text{if $\delta_{p}
&gt; 0$}\\[.5cm]
\log (1+W) &amp; \text{if $\delta_{p} = 0$},
\end{cases}
\end{equation*}\]</span> with <span class="math inline">\(W=Y\)</span>,
if <span class="math inline">\(Y &gt; 0\)</span>, and <span class="math inline">\(W=Y/(1-Y)\)</span>, if <span class="math inline">\(Y \in (0,1)\)</span>. The additional parameter
<span class="math inline">\(\delta_{p}\)</span> controls the asymmetry:
symmetric forms of <span class="math inline">\(h_{I}\)</span> correspond
to <span class="math inline">\(\delta_p = 1\)</span> while asymmetric
forms of <span class="math inline">\(h_{I}\)</span> to <span class="math inline">\(\delta_p = 0\)</span>.</p>
<p>All transformation models discussed above can be fitted using a
two-stage (TS) estimator <span class="citation">(Chamberlain 1994;
Buchinsky 1995)</span> whereby <span class="math inline">\(\boldsymbol
\beta(p)\)</span> is estimated conditionally on a fine grid of values
for the transformation parameter(s). Alternatively, point estimation can
be approached using the RC process <span class="citation">(Mu and He
2007)</span>, which is akin to the process that leads to the RC test
introduced in the previous section. The RC estimator avoids the
troublesome inversion of the Box-Cox and Aranda-Ordaz transformations,
but it is computationally more intensive than the TS estimator.</p>
<p>There are several methods for interval estimation, including those
based on large-<span class="math inline">\(n\)</span> approximations and
the ubiquitous bootstrap. Both the TS and RC estimators have an
asymptotic normal distribution. The large-sample properties of the TS
estimator for monotonic quantile regression models have been studied by
<span class="citation">Powell (1991)</span> (see also <span class="citation">Chamberlain (1994)</span>;<span class="citation">Machado and Mata (2000)</span>). Under regularity
conditions, it can be shown that the TS estimator is unbiased and will
converge to a normal distribution with a sandwich-type limiting
covariance matrix which is easy to calculate. In contrast, the form of
the covariance matrix of the sampling distribution for the RC estimator
is rather complicated and its estimation requires resampling <span class="citation">(Mu and He 2007)</span>. Finally, if the transformation
parameter is assumed to be known, then conditional inference is
apposite. In this case, the estimation procedures simplify to those for
standard quantile regression problems.</p>
<p>In <strong>Qtools</strong>, model fitting for one-parameter
transformation models can be carried out using the function
<tt>tsrq</tt>. The <tt>formula</tt> argument specifies the model for the
linear predictor as in (7), while the argument <tt>tsf</tt> provides the
desired transformation <span class="math inline">\(h\)</span> as
specified in Equations 10-13: <tt>bc</tt> for the Box–Cox model,
<tt>ao</tt> for Aranda-Ordaz families, and <tt>mcjI</tt> for proposal I
transformations. Additional arguments in the function <tt>tsrq</tt>
include</p>
<ul>
<li><tt>symmetry</tt>, a logical flag to specify the symmetric or
asymmetric version of <tt>ao</tt> and <tt>mcjI</tt>;</li>
<li><tt>dbounded</tt>, a logical flag to specify whether the response
variable is doubly bounded (default is strictly positive, i.e. singly
bounded);</li>
<li><tt>lambda</tt>, a numerical vector to define the grid of values for
estimating <span class="math inline">\(\lambda_p\)</span>; and
<tt>conditional</tt>, a logical flag indicating whether <span class="math inline">\(\lambda_{p}\)</span> is assumed to be known (in
which case the argument <tt>lambda</tt> provides such known value).
\end{itemize}</li>
</ul>
<p>There are other functions to fit transformation models. The function
<tt>rcrq</tt> fits one-parameter transformation models using the RC
estimator. The functions <tt>tsrq2</tt> and <tt>nlrq2</tt> are specific
to Geraci and Jones’s (2015) Proposal II transformations. The former
employs a two-way grid search while the latter is based on Nelder-Mead
optimization as implemented in <tt>optim</tt>. Simulation studies in
<span class="citation">Geraci and Jones (2015)</span> suggest that,
although computationally slower, a two grid search is numerically more
stable than the derivative-free approach.</p>
<p>A summary of the basic differences between all fitting functions is
given in Table 3. The table also shows the available methods in
<tt>summary.rqt</tt> to estimate standard errors and confidence
intervals for the model’s parameters. Unconditional inference is carried
out jointly on <span class="math inline">\(\boldsymbol \beta(p)\)</span>
and the transformation parameter by means of bootstrap using the package
<strong>boot</strong> <span class="citation">(Canty and Ripley 2014;
Davison and Hinkley 1997)</span>. Large-<span class="math inline">\(n\)</span> approximations <span class="citation">(Powell 1991; Chamberlain 1994; Machado and Mata
2000)</span> are also available for the one-parameter TS estimator under
<em>iid</em> or <em>nid</em> assumptions.</p>
<p>When <tt>summary.rqt</tt> is executed with the argument
<tt>conditional = TRUE</tt>, confidence interval estimation for <span class="math inline">\(\boldsymbol \beta_{p}\)</span> is performed with
one of the several methods developed for linear quantile regression
estimators (see options <tt>rank</tt>, <tt>iid</tt>, <tt>nid</tt>,
<tt>ker</tt>, and <tt>boot</tt> in <tt>quantreg::summary.rq</tt>).</p>
<table>
<tr>
<td>
Function name
<td>
<td>
Transformation parameters
<td>
<td>
Estimation
<td>
<td>
Standard errors or confidence intervals
<td>
<td>
<td>
<tr>
<td>
<td>
<td>
<td>
<td>
<td>
<td>
Unconditional
<td>
<td>
Conditional
<td>
</tr>
<td>
<tt>tsrq</tt>
<td>
<td>
1
<td>
<td>
Two-stage
<td>
<td>
<tt>iid</tt>, <tt>nid</tt>, <tt>boot</tt>
<td>
<td>
All types
<td>
</tr>
<td>
<tt>rcrq</tt>
<td>
<td>
1
<td>
<td>
Residual cusum process
<td>
<td>
<tt>boot</tt>
<td>
<td>
All types
<td>
</tr>
<td>
<tt>tsrq2</tt>
<td>
<td>
2
<td>
<td>
Two-stage
<td>
<td>
<tt>boot</tt>
<td>
<td>
All types
<td>
</tr>
<td>
<tt>nlrq2</tt>
<td>
<td>
2
<td>
<td>
Nelder–Mead
<td>
<td>
<tt>boot</tt>
<td>
<td>
–
<td>
Table 3: Transformation-based quantile regression in package
<strong>Qtools</strong>. ‘All types’ consists of options <tt>rank</tt>,
<tt>iid</tt>, <tt>nid</tt>, <tt>ker</tt>, and <tt>boot</tt> as provided
by function <tt>summary</tt> in package <strong>quantreg</strong>.
</table>
<p>In the New York Air Quality data example, a linear model was found
unsuitable to describe the relationship between ozone and solar
radiation. At closer inspection, Figure 4 reveals that the conditional
distribution of ozone may in fact be nonlinearly associated with solar
radiation, at least for some of the conditional quantiles. The model
<span class="math display">\[\begin{equation}\label{eq:15}
\tag{15}
Q_{h_{Is}\{\text{ozone}\}}(p) = \beta_{0}(p) + \beta_{1}(p) \cdot
\text{Solar.R},
\end{equation}\]</span> where <span class="math inline">\(h_{Is}\)</span> denotes the symmetric version of
(13) for a singly bounded response variable, is fitted for the quantiles
<span class="math inline">\(p \in \{0.1,0.5,0.9\}\)</span> using the
following code:</p>
<pre><code>&gt; system.time(fit.rqt &lt;- tsrq(Ozone ~ Solar.R, data = dd, tsf = &quot;mcjI&quot;,
+    symm = TRUE, dbounded = FALSE, lambda = seq(1, 3, by = 0.005),
+    conditional = FALSE, tau = c(.1, .5, .9)))
   user  system elapsed
    0.5     0.0     0.5
&gt; fit.rqt

call:
tsrq(formula = Ozone ~ Solar.R, data = dd, tsf = &quot;mcjI&quot;, symm = TRUE,
    dbounded = FALSE, lambda = seq(1, 3, by = 0.005), conditional = FALSE,
    tau = c(0.1, 0.5, 0.9))

Proposal I symmetric transformation (singly bounded response)

Optimal transformation parameter:
tau = 0.1 tau = 0.5 tau = 0.9
    2.210     2.475     1.500

Coefficients linear model (transformed scale):
             tau = 0.1  tau = 0.5 tau = 0.9
(Intercept) -3.3357578 -48.737341 16.557327
Solar.R      0.4169697   6.092168  1.443407

Degrees of freedom: 111 total; 109 residual</code></pre>
<p>The TS estimator makes a search for <span class="math inline">\(\lambda_{p}\)</span> over the grid <span class="math inline">\(1.000, 1.005, \ldots, 2.995, 3.000\)</span>. The
choice of the search interval usually results from a compromise between
accuracy and performance: the coarser the grid, the faster the
computation but the less accurate the estimate. A reasonable approach
would be to start with a coarse, wide-ranging grid (e.g. <tt>seq(-5, 5,
by = 0.5)</tt>), then center the interval about the resulting estimate
using a finer grid, and re-fit the model.</p>
<p>The output above reports the estimates <span class="math inline">\(\boldsymbol{\hat{\beta}}(p)\)</span> and <span class="math inline">\(\hat{\lambda}_p\)</span> for each quantile level
specified in <tt>tau</tt>. Here, the quantities of interest are the
predictions on the ozone scale and the marginal effect of solar
radiation, which can obtained using the function
<tt>predict.rqt</tt>.</p>
<pre><code>&gt; x &lt;- seq(9, 334, length = 200)
&gt; qhat &lt;- predict(fit.rqt, newdata = data.frame(Solar.R = x),
+    type = &quot;response&quot;)
&gt; dqhat &lt;- predict(fit.rqt, newdata = data.frame(Solar.R = x),
+    type = &quot;maref&quot;, namevec = &quot;Solar.R&quot;)
The linear component of the marginal effect is calculated as derivative of
 Ozone ~ beta1 * Solar.R
 with respect to Solar.R</code></pre>
<p>The calculations above are based on a sequence of 200 ozone values in
the interval <span class="math inline">\([9,334]\)</span> Ly, as
provided via the argument <tt>newdata</tt> (if this argument is missing,
the function returns the fitted values). There are three types of
predictions available:</p>
<ol style="list-style-type: decimal">
<li><tt>link</tt>—predictions of conditional quantiles on the
transformed scale (7), i.e. <span class="math display">\[\hat{Q}_{h\left(Y;\hat{\lambda}_{p}\right)}(p) =
\mathbf{x}^{T}\hat{\boldsymbol{\beta}}(p);\]</span></li>
<li><tt>response</tt>—predictions of conditional quantiles on the
original scale (8), i.e. <span class="math display">\[\hat{Q}_{Y|X}(p) =
h^{-1}\left\{\mathbf{x}^{\top}\hat{\boldsymbol{\beta}}(p);
\hat{\lambda}_{p}\right\};\]</span> and</li>
<li><tt>maref</tt>—predictions of the marginal effect (9).</li>
</ol>
<p>In the latter case, the argument <tt>namevec</tt> is used to specify
the name of the covariate with respect to which the marginal effect has
to be calculated. The function <tt>maref.rqt</tt> computes derivatives
symbolically using the <strong>stats</strong> function <tt>deriv</tt>
and these are subsequently evaluated numerically. While the nonlinear
component of the marginal effect in Equation 9 (i.e. <span class="math inline">\(\partial Q(p)/\partial \eta(p)\)</span>) is rather
straightforward to derive for any of the transformations (10)-(13), the
derivative of the linear predictor (i.e. <span class="math inline">\(\partial \eta(p)/\partial x_{j}\)</span>) requires
parsing the <tt>formula</tt> argument in order to obtain an expression
suitable for <tt>deriv</tt>. The function <tt>maref.rqt</tt> can handle
simple expressions with common functions like <tt>log</tt>,
<tt>exp</tt>, etc., interaction terms, and `as is’ terms
(i.e. <tt>I()</tt>). However, using functions that are not recognised by
<tt>deriv</tt> will trigger an error.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">Figure 5. Predicted 10th (solid line), 50th (dashed
line), and 90th (dot-dashed line) centiles of ozone conditional on solar
radiation (a) and corresponding estimated marginal effects (b) using the
symmetric proposal I transformation in the New York Air Quality data
set.</p>
</div>
<p>The predicted quantiles of ozone and the marginal effects of solar
radiation are plotted in Figure 5 using the following code:</p>
<pre><code>&gt; par(mfrow = c(1, 2))
&gt; plot(Ozone ~ Solar.R, data = dd, xlab = &quot;Solar radiation (lang)&quot;,
+    ylab = &quot;Ozone (ppb)&quot;)
&gt; for(i in 1:3) lines(x, qhat[ ,i], lty = c(1, 2, 4)[i], lwd = 2)
&gt; plot(range(x), range(dqhat), type = &quot;n&quot;, xlab = &quot;Solar radiation (lang)&quot;,
+    ylab = &quot;Marginal effect&quot;)
&gt; for(i in 1:3) lines(x, dqhat[ ,i], lty = c(1, 2, 4)[i], lwd = 2)</code></pre>
<p>The effect of solar radiation on different quantiles of ozone levels
shows a nonlinear behavior, especially at lower ranges of radiation
(below <span class="math inline">\(50\)</span> Ly) and on the median
ozone. It might be worth testing the goodness-of-fit of the model. In
the previous analysis, it was found evidence of lack of fit for the
linear specification (5). In contrast, the output reported below
indicates that, in general, the goodness of fit of the quantile models
based on the transformation model (15) has improved since the test
statistics are now smaller at all values of <span class="math inline">\(p\)</span>. However, such improvement is not yet
satisfactory for the median.</p>
<pre><code>&gt; GOFTest(fit.rqt, alpha = 0.05, B = 1000, seed = 416)

Goodness-of-fit test for quantile regression based on the cusum process
Quantile 0.1: Test statistic = 0.0393; p-value = 0.025
Quantile 0.5: Test statistic = 0.1465; p-value = 0.005
Quantile 0.9: Test statistic = 0.0212; p-value = 0.127</code></pre>
<p>The TS and RC estimators generally provide similar estimates and
predictions. However, computation based on the cusum process tends to be
somewhat slow, as shown further below. This is also true for the RC test
provided by <tt>GOFTest</tt>.</p>
<pre><code>&gt; system.time(fit.rqt &lt;- rcrq(Ozone ~ Solar.R, data = dd, tsf = &quot;mcjI&quot;,
+    symm = TRUE, dbounded = FALSE, lambda = seq(1, 3, by = 0.005),
+    tau = c(.1, .5, .9)))
   user  system elapsed
  36.88    0.03   37.64</code></pre>
<p>An example using doubly bounded transformations is demonstrated using
the A-level Chemistry Scores data set. The latter is available from
<strong>Qtools</strong> and it consists of 31022 observations of A-level
scores in Chemistry for England and Wales students, 1997. The data set
also includes information of prior academic achievement as assessed with
General Certificate of Secondary Education (GCSE) average scores. The
goal is to evaluate the ability of GCSE to predict A-level scores. The
latter are based on national exams in specific subjects (e.g. chemistry)
with grades ranging from A to F. For practical purposes, scores are
converted numerically as follows: A = 10, B = 8, C = 6, D = 4, E = 2,
and F = 0. The response is therefore doubly bounded between 0 ad 10. It
should be noted that this variable is discrete, although, for the sake
of simplicity, here it is assumed that the underlying process is
continuous.</p>
<p>The model considered here is <span class="math display">\[\begin{equation}\label{eq:16}
\tag{16}
Q_{h_{AOa}\{\text{score}\}}(p) = \beta_{0}(p) + \beta_{1}(p) \cdot
\text{gcse},
\end{equation}\]</span> where <span class="math inline">\(h_{AOa}\)</span> denotes the asymmetric
Aranda-Ordaz transformation in (12). This model is fitted for <span class="math inline">\(p = 0.9\)</span>:</p>
<pre><code>&gt; data(Chemistry)
&gt; fit.rqt &lt;- tsrq(score ~ gcse, data = Chemistry, tsf = &quot;ao&quot;, symm = FALSE,
+    lambda = seq(0,2,by=0.01), tau = 0.9)</code></pre>
<p>The predicted <span class="math inline">\(90\)</span>th centile of
A-level scores conditional on GCSE and the marginal effect of GCSE are
plotted in Figure 6. There is clearly a positive, nonlinear association
between the two scores. The nonlinearity is partly explained by the
floor and ceiling effects which result from the boundedness of the
measurement scale. Note, however, that the S-shaped curve is not
symmetric about the inflection point. As a consequence, the marginal
effect is skewed to the left. Indeed, the estimate <span class="math inline">\(\hat{\lambda}_{0.9} = 0\)</span> and the narrow
confidence interval give support to a complementary log-log
transformation:</p>
<pre><code>&gt; summary(fit.rqt, conditional = FALSE, se = &quot;nid&quot;)

call:
summary.rqt(object = fit.rqt, se = &quot;nid&quot;, conditional = FALSE)

Aranda-Ordaz asymmetric transformation (doubly bounded response)

Summary for unconditional inference

tau =  0.9

Optimal transformation parameter:
       Value   Std. Error  Lower bound  Upper bound
 0.000000000  0.001364422 -0.002674218  0.002674218

Coefficients linear model (transformed scale):
                 Value  Std. Error Lower bound Upper bound
(Intercept) -4.3520060 0.015414540  -4.3822179  -4.3217941
gcse         0.8978072 0.002917142   0.8920898   0.9035247

Degrees of freedom: 31022 total; 31020 residual</code></pre>
<p>Alternatively, one can estimate the parameter <span class="math inline">\(\delta_{p}\)</span> using a two-parameter
transformation:</p>
<pre><code>&gt; coef(tsrq2(score ~ gcse, data = chemsub, dbounded = TRUE,
+    lambda = seq(0, 2, by = 0.1), delta = seq(0, 2, by = 0.1),
+    tau = 0.9), all = TRUE)

(Intercept)        gcse      lambda       delta
 -4.1442274   0.8681246   0.0000000   0.0000000</code></pre>
<p>These results confirm the asymmetric nature of the relationship since
<span class="math inline">\(\hat{\delta}_{0.9} = 0\)</span>. Similar
results (not shown) were obtained with <tt>nlrq2</tt>.</p>
<p>In conclusion, the package <strong>Qtools</strong> offers several
options in terms of transformations and estimation algorithms, the
advantages and disadvantages of which are discussed by . In particular,
they found that the symmetric Proposal I transformation improves
considerably on the Box-Cox method and marginally on the Aranda-Ordaz
transformation in terms of mean squared error of the predictions. Also,
asymmetric transformations do not seem to improve sufficiently often on
symmetric transformations to be especially recommendable. However, the
Box-Cox and the symmetric Aranda-Ordaz transformations should not be
used when individual out-of-range predictions represent a potential
inconvenience as, for example, in multiple imputation (see section
further below). Finally, in some situations transformation-based
quantile regression may be competitive as compared to methods based on
smoothing, as demonstrated by a recent application to anthropometric
charts <span class="citation">(Boghossian et al. 2016)</span>.</p>
</div>
<div id="conditional-lss" class="section level2">
<h2>Conditional LSS</h2>
<p>Quantile-based measures of location, scale, and shape can be assessed
<em>conditionally</em> on covariates. A simple approach is to a fit a
linear model as in (4) or a transformation-based model as in (7), and
then predict <span class="math inline">\(\hat{Q}_{Y|X}(p)\)</span> to
obtain the conditional LSS measures in Equation 3 for specific values of
<span class="math inline">\(\mathbf{x}\)</span>.</p>
<p>Estimation of conditional LSS can be carried out by using the
function <tt>qlss.formula</tt>. The conditional model is specified in
the argument <tt>formula</tt>, while the probability <span class="math inline">\(p\)</span> is given in <tt>probs</tt>. (As seen in
Equation 3, the other probabilities of interest to obtain the
decomposition of the conditional quantiles are <span class="math inline">\(1-p\)</span>, <span class="math inline">\(0.25\)</span>, <span class="math inline">\(0.5\)</span>, and <span class="math inline">\(0.75\)</span>.) The argument <tt>type</tt>
specifies the required type of regression model, more specifically
<tt>rq</tt> for linear models and <tt>rqt</tt> for transformation-based
models. The function <tt>qlss.formula</tt> will take any additional
argument to be passed to <tt>quantreg::rq</tt> or <tt>tsrq</tt>
(e.g. <tt>subset</tt>, <tt>weights</tt>, etc.).</p>
<p>Let’s consider the New York Air Quality data example discussed in the
previous section and assume that the transformation model (15) holds for
the quantiles <span class="math inline">\(p \in \{0.05, 0.1, 0.25, 0.5,
0.75,\)</span> <span class="math inline">\(0.9, 0.95\}\)</span>. Then
the conditional LSS summary of the distribution of ozone conditional on
solar radiation for <span class="math inline">\(p = 0.05\)</span> and
<span class="math inline">\(p = 0.1\)</span> is calculated as
follows:</p>
<pre><code>&gt; fit.qlss &lt;- qlss(formula = Ozone ~ Solar.R, data = airquality, type =
+    &quot;rqt&quot;, tsf = &quot;mcjI&quot;, symm = TRUE, dbounded = FALSE,  lambda =
+    seq(1, 3, by = 0.005), probs = c(0.05, 0.1))
&gt; fit.qlss

call:
qlss.formula(formula = Ozone ~ Solar.R, probs = c(0.05, 0.1),
    data = airquality, type = &quot;rqt&quot;, tsf = &quot;mcjI&quot;, symm = TRUE,
    dbounded = FALSE, lambda = seq(1, 3, by = 0.005))

Conditional Quantile-Based Location, Scale, and Shape
-- Values are averaged over observations --

** Location **
Median
[1] 30.2258
** Scale **
Inter-quartile range (IQR)
[1] 43.40648
Inter-quantile range (IPR)
    0.05      0.1
88.02909 73.93430
**Shape**
Skewness index
     0.05       0.1
0.5497365 0.5180108
Shape index
    0.05      0.1
1.960315 1.661648</code></pre>
<p>The output, which is of class <tt>“qlss”</tt>, is a named list with
the same LSS measures seen in the case of unconditional quantiles.
However, these are now conditional on solar radiation. By default, the
predictions are the fitted values, which are averaged over observations
for printing purposes. An optional data frame for predictions can be
given via the argument <tt>newdata</tt> in <tt>predict.qlss</tt>. If
<tt>interval = TRUE</tt>, the latter computes confidence intervals at
the specified <tt>level</tt> using <tt>R</tt> bootstrap replications (it
is, therefore, advisable to set the seed before calling
<tt>predict.qlss</tt>). The conditional LSS measures can be conveniently
plotted using the <tt>plot.qlss</tt> function as shown in the code
below. The argument <tt>z</tt> is required and specifies the covariate
used for plotting. Finally, the argument <tt>whichp</tt> specifies one
probability (and one only) among those given in <tt>probs</tt> that
should be used for plotting (e.g. <span class="math inline">\(p =
0.1\)</span> in the following example).</p>
<pre><code>&gt; set.seed(567)
&gt; x &lt;- seq(9, 334, length = 200)
&gt; qhat &lt;- predict(fit.qlss, newdata = data.frame(Solar.R = x),
+    interval = TRUE, level = 0.90, R = 500)
&gt; plot(qhat, z = x, whichp = 0.1, interval = TRUE, type = &quot;l&quot;,
+    xlab = &quot;Solar radiation (lang)&quot;, lwd = 2)</code></pre>
<p>Figure 7 shows that both the median and the IQR of ozone increase
nonlinearly with increasing solar radiation. The distribution of ozone
is skewed to the right and the degree of asymmetry is highest at low
values of solar radiation. This is due to the extreme curvature of the
median which takes on values close to the 10th centile (Figure 5).
(Recall that the index approaches 1 when <span class="math inline">\(Q(p) \approx Q(0.5)\)</span>.) However, the
sparsity of observations at the lower end of the observed range of solar
radiation determines substantial uncertainty as reflected by the wider
confidence interval (Figure 7). At <span class="math inline">\(p =
0.1\)</span>, the conditional shape index is on average equal to <span class="math inline">\(1.66\)</span> and it increases monotonically from
<span class="math inline">\(1.32\)</span> to about <span class="math inline">\(1.85\)</span>, remaining always below the
tail-weight threshold of a normal distribution (<span class="math inline">\(1.90\)</span>).</p>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">Figure 7. Location, scale and shape of ozone levels
conditional on solar radiation in the New York Air Quality data set.
Dashed lines denote the bootstrapped <span class="math inline">\(90%\)</span> point-wise confidence intervals.</p>
</div>
</div>
</div>
<div id="other-functions-in-qtools" class="section level1">
<h1>Other functions in <strong>Qtools</strong></h1>
<div id="restricted-quantile-regression" class="section level2">
<h2>Restricted quantile regression</h2>
<p>Besides a loss of precision, high sparsity (low density) might also
lead to a violation of the basic property of monotonicity of quantile
functions. Quantile crossing occurs when <span class="math inline">\(\mathbf{x}_{i}^{\top}\hat{\boldsymbol \beta}(p)
&gt; \mathbf{x}_{i}^{\top}\hat{\boldsymbol \beta}(p&#39;)\)</span> for
some <span class="math inline">\(\mathbf{x}_{i}\)</span> and <span class="math inline">\(p &lt; p&#39;\)</span>. This problem typically
occurs in the outlying regions of the design space <span class="citation">(Koenker 2005)</span> where also sparsity occurs more
frequently. Balanced designs with larger sample sizes would then offer
some assurance against quantile crossing, provided, of course, that the
QR models are correctly specified. Model’s misspecification, indeed, can
still be a cause of crossing of the quantile curves. Restricted
regression quantiles (RRQ) <span class="citation">(X. He 1997)</span>
might offer a practical solution when little can be done in terms of
modelling. This approach applies to a subclass of linear models <span class="math display">\[
Y = \mathbf{x}^{\top}\beta + \epsilon
\]</span> and linear heteroscedastic models <span class="math display">\[
Y = \mathbf{x}^{\top}\beta + (\mathbf{x}^{\top}\gamma)\,\epsilon,
\]</span> where <span class="math inline">\(\mathbf{x}^{\top}\gamma &gt;
0\)</span> and <span class="math inline">\(\epsilon \sim F\)</span>.
Basically, it consists in fitting a reduced regression model passing
through the origin. The reader is referred to for details. Here, it is
worth stressing that when the restriction does not hold, i.e. if the
model is more complex than a location–scale-shift model, then RRQ may
yield unsatisfactory results . See also for an examination of the
asymptotic properties of the restricted QR estimator. In particular, the
relative efficiency of RRQ as compared to RQ depends on the error
distribution. For some common unimodal distributions, showed that RRQ in
<em>iid</em> models is more efficient than RQ. This property is lost
when the error is asymmetric. In contrast, the efficiency of RRQ in
heteroscedastic models is comparable to that of RQ even for small
samples.</p>
<p>The package <strong>Qtools</strong> provides the functions
<tt>rrq</tt>, <tt>rrq.fit</tt> and <tt>rrq.wfit</tt> which are,
respectively, the ‘restricted’ analogous of <tt>rq</tt>,
<tt>rq.fit</tt>, and <tt>rq.wfit</tt> in <strong>quantreg</strong>. S3
methods <tt>print</tt>, <tt>coef</tt>, <tt>predict</tt>,
<tt>fitted</tt>, <tt>residuals</tt>, and <tt>summary</tt> are available
for objects of class <tt>“rrq”</tt>. In particular, confidence intervals
are obtained using the functions <tt>boot</tt> and <tt>boot.ci</tt> from
package <strong>boot</strong>. Future versions of the package will
develop the function <tt>summary.rrq</tt> to include asymptotic standard
errors <span class="citation">(Zhao 2000)</span>. An application is
shown below using an example discussed by . The data set, available from
<strong>Qtools</strong>, consists of <span class="math inline">\(118\)</span> measurements of esterase
concentrations and number of bindings counted in binding
experiments.</p>
<pre><code>&gt; data(&quot;esterase&quot;)
&gt; taus &lt;- c(.1, .25, .5, .75, .9)
&gt; fit.rq &lt;- rq(Count ~ Esterase, data = esterase, tau = taus)
&gt; yhat1 &lt;- fitted(fit.rq)
&gt; fit.rrq &lt;- rrq(Count ~ Esterase, data = esterase, tau = taus)
&gt; yhat2 &lt;- fitted(fit.rrq)</code></pre>
<p>The predicted 90th centile curve crosses the 50th and 75th curves at
lower esterase concentrations (Figure 8). The crossing is removed in
predictions based on RRQs.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">Figure 8. Predicted quantiles of number of bindings
conditional on esterase concentration using regression quantiles (a) and
restricted regression quantiles (b) in the Esterase data set.</p>
</div>
<p>As discussed above, the reliability of the results depends on the
validity of the restriction carried by RRQ. A quick check can be
performed using the location–scale-shift specification of the Khmaladze
test.</p>
<pre><code>&gt; kt &lt;- KhmaladzeTest(formula = Count ~ Esterase, data = esterase,
+ taus = seq(.05,.95,by = .01), nullH = &quot;location-scale&quot;)
&gt; KhmaladzeFormat(kt, 0.05)

Khmaladze test for the location-shift hypothesis
Joint test is not significant at 10% level
Test(s) for individual slopes:
 not significant at 10% level</code></pre>
<p>The quantile crossing problem can be approached also by directly
rearranging the fitted values <span class="math inline">\(\hat{Q}_{Y|X =
\mathbf{x}}(p)\)</span> to obtain monotone (in <span class="math inline">\(p\)</span>) predictions for each <span class="math inline">\(\mathbf{x}\)</span> <span class="citation">(Chernozhukov, Fernandez-Val, and Galichon
2010)</span>. This method is implemented in the package
<strong>Rearrangement</strong> <span class="citation">(Graybill et al.
2016)</span>. As compared to RRQ, this approach is more general as it is
not confined to, for example, location–scale-shift models <span class="citation">(Chernozhukov, Fernandez-Val, and Galichon
2010)</span>; however, in contrast to RRQ, it does not yield estimates
of parameters (e.g. slopes) of the model underlying the final
monotonised curves. Such estimates, available from <tt>rrq</tt> objects,
may be of practical utility when summarising the results.</p>
</div>
<div id="conditional-quantiles-of-discrete-data" class="section level2">
<h2>Conditional quantiles of discrete data</h2>
<p>Modeling discrete response variables, such as categorical and count
responses, has been traditionally approached with distribution-based
methods: a parametric model <span class="math inline">\(F_{Y|X}(y;\theta)\)</span> is assumed and then
fitted by means of MLE. Binomial, negative binomial, multinomial and
Poisson regressions are well-known in many applied sciences. Because of
the computational advantages and the asymptotic properties of MLE, these
methods have long ruled among competing alternatives.</p>
<p>Modeling conditional functions of discrete data is less common and,
on a superficial level, might even appear as an unnecessary
complication. However, a deeper look at its rationale will reveal that a
distribution-free analysis can provide insightful information in the
discrete case as it does in the continuous case. Indeed, methods for
conditional quantiles of continuous distributions can be—and have
been—adapted to discrete responses.</p>
<div id="jittering-for-count-responses" class="section level3">
<h3>Jittering for count responses</h3>
<p>Let <span class="math inline">\(Y\)</span> be a count variable such
as, for example, the number of car accidents during a week or the number
of visits of a patient to their doctor during a year. As usual, <span class="math inline">\(X\)</span> denotes a vector of covariates. Poisson
regression, which belongs to the family of generalized linear models
(GLMs), is a common choice for this kind of data, partly because of its
availability in many statistical packages. Symbolically, <span class="math inline">\(Y \sim \textrm{Pois}(\theta)\)</span> where <span class="math display">\[
\theta \equiv \mathrm{E}(Y|X = \mathbf{x}) =
h^{-1}\left(\mathbf{x}^{\top}\boldsymbol{\beta}\right)
\]</span> and <span class="math inline">\(h\)</span> is the logarithmic
link function. Note that the variance also is equal to <span class="math inline">\(\theta\)</span>. Indeed, moments of order higher
than <span class="math inline">\(2\)</span> governing the shape of the
distribution depend on the same parameter. Every component of the
conditional LSS in a Poisson model is therefore controlled by <span class="math inline">\(\theta\)</span>. If needed, more flexibility can
be achieved using a distribution-free approach.</p>
<p><span class="citation">Machado and Santos Silva (2005)</span>
proposed the model <span class="math display">\[\begin{equation}\label{eq:17}
\tag{17}
Q_{h\left(Z;p\right)}(p) = \mathbf{x}^{\top}\boldsymbol \beta(p),
\end{equation}\]</span> where <span class="math inline">\(Z = Y +
U\)</span> is obtained by jittering <span class="math inline">\(Y\)</span> with a <span class="math inline">\([0,1)\)</span>-uniform noise <span class="math inline">\(U\)</span>, independent of <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span>. In principle, any monotone
transformation <span class="math inline">\(h\)</span> can be considered.
A natural choice for count data is a log-linear model , i.e. <span class="math display">\[\begin{equation*}
h\left(Z;p\right) =
\begin{cases}
\log\left(Z - p\right) &amp; \text{for $Z &gt; p$}\\[.5cm]
\log \zeta &amp; \text{for $Z \leq p$}.
\end{cases}
\end{equation*}\]</span> where <span class="math inline">\(0 &lt; \zeta
&lt; p\)</span>. It follows that <span class="math inline">\(Q_{Z|X}(p)
= p + \exp\left(\mathbf{x}^{\top}\boldsymbol \beta(p)\right)\)</span>.
(Note that the <span class="math inline">\(p\)</span>th quantile of the
conditional distribution of <span class="math inline">\(Z\)</span> is
bounded below by <span class="math inline">\(p\)</span>.) Given the
continuity between counts induced by jittering, standard inference for
linear quantile functions <span class="citation">(Koenker and Bassett
1978)</span> can be applied to fit (17). In practice, a sample of <span class="math inline">\(M\)</span> jittered responses <span class="math inline">\(Z\)</span> is taken to estimate <span class="math inline">\(\hat{\boldsymbol \beta}_{m}(p)\)</span>, <span class="math inline">\(m = 1,\ldots,M\)</span>; the noise is then
averaged out, <span class="math inline">\(\hat{\boldsymbol \beta}(p) =
\frac{1}{M} \sum_{m} \hat{\boldsymbol \beta}_{m}(p)\)</span>.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">Figure 9. Predicted 10th, 50th, and 90th centiles of
number of bindings conditional on esterase concentration using Poisson
regression and distribution-free quantile regression (QR) based on
jittering in the Esterase data set.</p>
</div>
<p><span class="citation">Machado and Santos Silva (2005)</span>’s
methods, including large-<span class="math inline">\(n\)</span>
approximations for standard errors, are implemented in the function
<tt>rq.counts</tt>. The <tt>formula</tt> argument specifies a log-linear
model as in (17). Prior to version 1.4, flexible transformations as
described above (e.g., Box-Cox) were allowed. As of version 1.4 of the
package, this option has been removed since inference under
transformations other than logarithmic was found unreliable and this was
likely due to coding issues.</p>
<p>In the example below, estimation is carried out using <span class="math inline">\(M=50\)</span> jittered samples and <span class="math inline">\(\zeta = 10^{-5}\)</span> (see <span class="citation">Machado and Santos Silva (2005)</span> for further
details on these settings).</p>
<pre><code>R&gt; data(esterase)
R&gt; fit.rq.counts &lt;- rq.counts(formula = Count ~ Esterase, tau = 0.1,
+ data = esterase, M = 50, zeta = 1e-05)</code></pre>
<p>Figure 9 shows a contrast between centile curves as predicted by the
Poisson and the QR models in the Esterase data set. The Poisson
distribution clearly underestimates the variability in the data. An
empirical modeling of the conditional quantiles seems to be preferred in
this case. Of course, the assumption of log-linearity of the models
would need to be carefully assessed (note that <tt>GOFTest</tt> can be
applied also to <tt>rq.counts</tt> objects).</p>
</div>
<div id="conditional-mid-quantiles-for-discrete-responses" class="section level3">
<h3>Conditional mid-quantiles for discrete responses</h3>
<p><span class="citation">Geraci and Farcomeni (2019)</span> developed
quantile regression methods for discrete responses by extending Parzen’s
definition of marginal mid-quantiles which we discussed previously.
These methods are general as they can be applied to a large variety of
discrete responses, including binary, ordinal, and count variables.</p>
<p><span class="citation">Geraci and Farcomeni (2019)</span> first
defined the conditional mid-distribution function as <span class="math display">\[\begin{equation}\label{eq:18}
\tag{18}
G_{Y|X}(y) \equiv \Pr(Y \leq y|X) - 0.5\cdot \Pr(Y = y|X).
\end{equation}\]</span> Then, they introduced the <em>conditional</em>
mid-quantile function as its inverse, that is <span class="math inline">\(H_{Y|X}(p) \equiv G^{-1}_{Y|X}(p)\)</span>.</p>
<p>Estimation is carried out in a two-step approach. In the first step,
conditional mid-probabilities are obtained nonparametrically and, in the
second step, regression coefficients are estimated by solving an
implicit equation. When constraining the quantile index to a data-driven
admissible range, the second-step estimating equation has a
least-squares type, closed-form solution. Such estimator is shown to be
strongly consistent and asymptotically normal. Its good performance is
shown in a simulation study with data generated from different discrete
response models.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">Figure 10. Predicted 50th and 90th centiles of number
of bindings conditional on esterase concentration using Poisson
regression and mid-quantile regression (mid-QR) in the Esterase data
set.</p>
</div>
<p>In the example below, the function <tt>midrq</tt> is applied to the
Esterase data set to obtain 10th and 90th conditional mid-quantiles
(plotted in Figure 10). As opposed to <tt>rq.counts</tt>, the function
<tt>midrq</tt> supports Box-Cox and Aranda-Ordaz transformations. S3
methods for <tt>midrq</tt> objects (e.g., <tt>summary</tt>,
<tt>coef</tt>, <tt>predict</tt>, <tt>residuals</tt>, <tt>vcov</tt>) are
available in the <strong>Qtools</strong> package. The latter also
provides the function <tt>cmidecdf</tt> to fit the conditional mid-CDF.
See <span class="citation">Geraci and Farcomeni (2019)</span> for
details on estimation.</p>
<pre><code>R&gt; data(esterase)
R&gt; fit.midrq &lt;- midrq(Count ~ Esterase, tau = c(0.5, 0.9),
+ data = esterase, type = 1, lambda = 0)</code></pre>
</div>
</div>
<div id="quantile-based-multiple-imputation" class="section level2">
<h2>Quantile-based multiple imputation</h2>
<p>Regression models play an important role in conditional imputation of
missing values. QR can be used as an effective approach for multiple
imputation (MI) when location-shift models are inadequate <span class="citation">(Muñoz and Rueda 2009; Bottai and Zhen 2013; Geraci
2016)</span>.</p>
<p>In <strong>Qtools</strong>, <tt>mice.impute.rq</tt> and
<tt>mice.impute.rrq</tt> are auxiliary functions written to be used
along with the functions of the R package <strong>mice</strong> <span class="citation">(van Buuren and Groothuis-Oudshoorn 2011)</span>. The
former is based on the standard QR estimator (<tt>rq.fit</tt>) while the
latter on the restricted counterpart (<tt>rrq.fit</tt>). Both imputation
functions allow for the specification of the transformation-based QR
models discussed previously. The equivariance property is useful to
achieve linearity of the conditional model and to ensure that
imputations lie within some interval when imputed variables are bounded.
An example is available from the help file using the <tt>nhanes</tt>
data set. See also <span class="citation">Geraci (2016)</span> and <span class="citation">Geraci and McLain (2018)</span> for a thorough
description of these methods.</p>
</div>
</div>
<div id="final-remarks" class="section level1">
<h1>Final remarks</h1>
<p>Quantiles have long occupied an important place in statistics. The
package <strong>Qtools</strong> builds on recent methodological and
computational developments of quantile functions and related methods to
promote their application in statistical data modelling.</p>
</div>
<div id="acknowledgements" class="section level1">
<h1>Acknowledgements</h1>
<p>This work was partially supported by an ASPIRE grant from the Office
of the Vice President for Research at the University of South Carolina.
Please cite the Qtools package as: Geraci, M. (2016). Qtools: A
collection of models and other tools for quantile inference. R Journal,
8(2), 117-138.</p>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-aranda_1981" class="csl-entry">
Aranda-Ordaz, F. J. 1981. <span>“On Two Families of Transformations to
Additivity for Binary Response Data.”</span> <em>Biometrika</em> 68 (2):
357–63.
</div>
<div id="ref-azzalini_bowman_1990" class="csl-entry">
Azzalini, A., and A. W. Bowman. 1990. <span>“A Look at Some Data on the
<span>O</span>ld <span>F</span>aithful <span>G</span>eyser.”</span>
<em>Journal of the Royal Statistical Society C</em> 39 (3): 357–65.
</div>
<div id="ref-benjamini_krieger_1996" class="csl-entry">
Benjamini, Y., and A. M. Krieger. 1996. <span>“Concepts and Measures for
Skewness with Data-Analytic Implications.”</span> <em>Canadian Journal
of Statistics</em> 24 (1): 131–40.
</div>
<div id="ref-benoit_etal" class="csl-entry">
Benoit, D. F., R. Al-Hamzawi, K. Yu, and D. Van den Poel. 2014.
<em>bayesQR: Bayesian Quantile Regression</em>. <a href="https://cran.r-project.org/package=bayesQR">https://cran.r-project.org/package=bayesQR</a>.
</div>
<div id="ref-boghossian_etal" class="csl-entry">
Boghossian, N. S., M. Geraci, E. M. Edwards, K. A. Morrow, and J. D.
Horbar. 2016. <span>“Anthropometric Charts for Infants Born Between 22
and 29 Weeks’ Gestation.”</span> <em>Pediatrics</em>.
</div>
<div id="ref-bottai_zhen_2013" class="csl-entry">
Bottai, M., and H. Zhen. 2013. <span>“Multiple Imputation Based on
Conditional Quantile Estimation.”</span> <em>Epidemiology,
Biostatistics, and Public Health</em> 10 (1): e8758.
</div>
<div id="ref-box_cox" class="csl-entry">
Box, G. E. P., and D. R. Cox. 1964. <span>“An Analysis of
Transformations.”</span> <em>Journal of the Royal Statistical Society
B</em> 26 (2): 211–52.
</div>
<div id="ref-buchinsky_1995" class="csl-entry">
Buchinsky, M. 1995. <span>“Quantile Regression,
<span>B</span>ox-<span>C</span>ox Transformation Model, and the
<span>US</span> Wage Structure, 1963-1987.”</span> <em>Journal of
Econometrics</em> 65 (1): 109–54.
</div>
<div id="ref-boot" class="csl-entry">
Canty, A., and B. D. Ripley. 2014. <em>Boot: Bootstrap r (s-PLUS)
Functions</em>. <a href="https://cran.r-project.org/package=boot">https://cran.r-project.org/package=boot</a>.
</div>
<div id="ref-chamberlain_1994" class="csl-entry">
Chamberlain, G. 1994. <span>“Quantile Regression, Censoring, and the
Structure of Wages.”</span> In <em>Advances in Econometrics: Sixth World
Congress</em>, edited by C. Sims. Vol. 1. Cambridge, UK: Cambridge
University Press.
</div>
<div id="ref-chernozhukov_etal" class="csl-entry">
Chernozhukov, V., I. Fernandez-Val, and A. Galichon. 2010.
<span>“Quantile and Probability Curves Without Crossing.”</span>
<em>Econometrica</em> 78 (3): 1093–1125.
</div>
<div id="ref-davison_hinkley" class="csl-entry">
Davison, A. C., and D. V. Hinkley. 1997. <em>Bootstrap Methods and Their
Applications</em>. Cambridge: Cambridge University Press.
</div>
<div id="ref-dehbi_etal" class="csl-entry">
Dehbi, H.-M., M. Cortina-Borja, and M. Geraci. 2016.
<span>“Aranda-<span>O</span>rdaz Quantile Regression for Student
Performance Assessment.”</span> <em>Journal of Applied Statistics</em>
43 (1): 58–71.
</div>
<div id="ref-doksum" class="csl-entry">
Doksum, K. 1974. <span>“Empirical Probability Plots and Statistical
Inference for Nonlinear Models in the Two-Sample Case.”</span> <em>The
Annals of Statistics</em> 2 (2): 267–77.
</div>
<div id="ref-geraci_2104" class="csl-entry">
Geraci, M. 2014. <span>“Linear Quantile Mixed Models: The Lqmm Package
for <span>L</span>aplace Quantile Regression.”</span> <em>Journal of
Statistical Software</em> 57 (13): 1–29.
</div>
<div id="ref-geraci_2016" class="csl-entry">
———. 2016. <span>“Estimation of Regression Quantiles in Complex Surveys
with Data Missing at Random: An Application to Birthweight
Determinants.”</span> <em>Statistical Methods in Medical Research</em>
25 (4): 1393–1421.
</div>
<div id="ref-geraci_bottai_2014" class="csl-entry">
Geraci, M., and M. Bottai. 2014. <span>“Linear Quantile Mixed
Models.”</span> <em>Statistics and Computing</em> 24 (3): 461–79.
</div>
<div id="ref-geraci_farcomeni_2019" class="csl-entry">
Geraci, M., and A. Farcomeni. 2019. <span>“Mid-Quantile Regression for
Discrete Responses.”</span> <em>arXiv Preprint arXiv:1907.01945
[Stat.ME]</em>.
</div>
<div id="ref-geraci_jones_2015" class="csl-entry">
Geraci, M., and M. C. Jones. 2015. <span>“Improved Transformation-Based
Quantile Regression.”</span> <em>Canadian Journal of Statistics</em> 43
(1): 118–32.
</div>
<div id="ref-geraci_mclain_2018" class="csl-entry">
Geraci, M., and A. McLain. 2018. <span>“Multiple Imputation for Bounded
Variables.”</span> <em>Psychometrika</em> 83 (4): 919–40.
</div>
<div id="ref-gilchirst_2000" class="csl-entry">
Gilchrist, W. 2000. <em>Statistical Modelling with Quantile
Functions</em>. Boca Raton, FL: Chapman &amp; Hall/CRC.
</div>
<div id="ref-rearrangement" class="csl-entry">
Graybill, W., M. Chen, V. Chernozhukov, I. Fernandez-Val, and A.
Galichon. 2016. <em>Rearrangement: Monotonize Point and Interval
Functional Estimates by Rearrangement</em>. <a href="https://cran.r-project.org/package=Rearrangement">https://cran.r-project.org/package=Rearrangement</a>.
</div>
<div id="ref-groeneveld_1998" class="csl-entry">
Groeneveld, R. A. 1998. <span>“A Class of Quantile Measures for
Kurtosis.”</span> <em>The American Statistician</em> 52 (4): pp.
325–329.
</div>
<div id="ref-groeneveld_meeden_1984" class="csl-entry">
Groeneveld, R. A., and G. Meeden. 1984. <span>“Measuring Skewness and
Kurtosis.”</span> <em>Journal of the Royal Statistical Society D</em> 33
(4): pp. 391–399.
</div>
<div id="ref-hald_2003" class="csl-entry">
Hald, A. 2003. <em>A History of Probability and Statistics and Their
Applications Before 1750</em>. New York, NY: John Wiley &amp; Sons.
</div>
<div id="ref-he_1997" class="csl-entry">
He, X. 1997. <span>“Quantile Curves Without Crossing.”</span> <em>The
American Statistician</em> 51 (2): 186–92.
</div>
<div id="ref-he_zhu_2003" class="csl-entry">
He, X. M., and L. X. Zhu. 2003. <span>“A Lack-of-Fit Test for Quantile
Regression.”</span> <em>Journal of the American Statistical
Association</em> 98 (464): 1013–22.
</div>
<div id="ref-horn_1983" class="csl-entry">
Horn, P. S. 1983. <span>“A Measure for Peakedness.”</span> <em>The
American Statistician</em> 37 (1): 55–56.
</div>
<div id="ref-hyndman_fan_1996" class="csl-entry">
Hyndman, R. J., and Y. Fan. 1996. <span>“Sample Quantiles in Statistical
Packages.”</span> <em>The American Statistician</em> 50 (4): 361–65.
</div>
<div id="ref-jones_2007" class="csl-entry">
Jones, M. C. 2007. <span>“Connecting Distributions with Power Tails on
the Real Line, the Half Line and the Interval.”</span> <em>International
Statistical Review</em> 75 (1): 58–69.
</div>
<div id="ref-jones_etal_2011" class="csl-entry">
Jones, M. C., J. F. Rosco, and A. Pewsey. 2011.
<span>“Skewness-Invariant Measures of Kurtosis.”</span> <em>The American
Statistician</em> 65 (2): 89–95.
</div>
<div id="ref-khmaladze_etal_2004" class="csl-entry">
Khmaladze, E. V., and H. L. Koul. 2004. <span>“Martingale Transforms
Goodness-of-Fit Tests in Regression Models,”</span> 995–1034.
</div>
<div id="ref-koenker_2005" class="csl-entry">
Koenker, R. 2005. <em>Quantile Regression</em>. New York, NY: Cambridge
University Press.
</div>
<div id="ref-quantreg" class="csl-entry">
———. 2013. <em>Quantreg: Quantile Regression</em>. <a href="https://cran.r-project.org/package=quantreg">https://cran.r-project.org/package=quantreg</a>.
</div>
<div id="ref-koenker_bassett_1978" class="csl-entry">
Koenker, R., and G. Bassett. 1978. <span>“Regression Quantiles.”</span>
<em>Econometrica</em> 46 (1): 33–50.
</div>
<div id="ref-koenker_dorey" class="csl-entry">
Koenker, R., and V. D’Orey. 1987. <span>“Algorithm <span>AS</span> 229:
Computing Regression Quantiles.”</span> <em>Journal of the Royal
Statistical Society C</em> 36 (3): 383–93.
</div>
<div id="ref-koenker_machado_1999" class="csl-entry">
Koenker, R., and J. A. F. Machado. 1999. <span>“Goodness of Fit and
Related Inference Processes for Quantile Regression.”</span> <em>Journal
of the American Statistical Association</em> 94 (448): 1296–1310.
</div>
<div id="ref-koenker_park_1996" class="csl-entry">
Koenker, R., and B. J. Park. 1996. <span>“An Interior Point Algorithm
for Nonlinear Quantile Regression.”</span> <em>Journal of
Econometrics</em> 71 (1-2): 265–83.
</div>
<div id="ref-koenker_xiao" class="csl-entry">
Koenker, R., and Z. J. Xiao. 2002. <span>“Inference on the Quantile
Regression Process.”</span> <em>Econometrica</em> 70 (4): 1583–1612.
</div>
<div id="ref-lehmann" class="csl-entry">
Lehmann, E. L. 1975. <em>Nonparametrics: Statistical Methods Based on
Ranks</em>. San Francisco, CA: Holden-Day.
</div>
<div id="ref-ma_etal_2011" class="csl-entry">
Ma, Y., M. G. Genton, and E. Parzen. 2011. <span>“Asymptotic Properties
of Sample Quantiles of Discrete Distributions.”</span> <em>Annals of the
Institute of Statistical Mathematics</em> 63 (2): 227–43.
</div>
<div id="ref-machado_mata" class="csl-entry">
Machado, J. A. F., and J. Mata. 2000. <span>“Box–<span>C</span>ox
Quantile Regression and the Distribution of Firm Sizes.”</span>
<em>Journal of Applied Econometrics</em> 15 (3): 253–74.
</div>
<div id="ref-machado_silva_2005" class="csl-entry">
Machado, J. A. F., and J. M. C. Santos Silva. 2005. <span>“Quantiles for
Counts.”</span> <em>Journal of the American Statistical Association</em>
100 (472): 1226–37.
</div>
<div id="ref-mu_he" class="csl-entry">
Mu, Y. M., and X. M. He. 2007. <span>“Power Transformation Toward a
Linear Regression Quantile.”</span> <em>Journal of the American
Statistical Association</em> 102 (477): 269–79.
</div>
<div id="ref-munoz_rueda_2009" class="csl-entry">
Muñoz, J. F., and M. Rueda. 2009. <span>“New Imputation Methods for
Missing Data Using Quantiles.”</span> <em>Journal of Computational and
Applied Mathematics</em> 232 (2): 305–17.
</div>
<div id="ref-parzen_1979" class="csl-entry">
Parzen, E. 1979. <span>“Nonparametric Statistical Data Modeling.”</span>
<em>Journal of the American Statistical Association</em> 74 (365):
105–21.
</div>
<div id="ref-parzen_2004" class="csl-entry">
———. 2004. <span>“Quantile Probability and Statistical Data
Modeling.”</span> <em>Statistical Science</em> 19 (4): 652–62.
</div>
<div id="ref-powell_1991" class="csl-entry">
Powell, J. L. 1991. <span>“Estimation of Monotonic Regression Models
Under Quantile Restrictions.”</span> In <em>Nonparametric and
Semiparametric Methods in Econometrics and Statistics: Proceedings of
the Fifth International Symposium on Economic Theory and
Econometrics</em>, edited by W. Barnett, J. Powell, and G. Tauchen,
357–84. New York, NY: Cambridge University Press.
</div>
<div id="ref-powell_1994" class="csl-entry">
———. 1994. <span>“Estimation of Semiparametric Models.”</span> In
<em>Handbook of Econometrics</em>, edited by F. Engle Robert and L.
McFadden Daniel, Volume 4:2443–2521. Elsevier.
</div>
<div id="ref-ruppert_1987" class="csl-entry">
Ruppert, D. 1987. <span>“What Is Kurtosis?: An Influence Function
Approach.”</span> <em>The American Statistician</em> 41 (1): 1–5.
</div>
<div id="ref-smith_reich" class="csl-entry">
Smith, L., and B. Reich. 2013. <em>BSquare: Bayesian Simultaneous
Quantile Regression</em>. <a href="https://cran.r-project.org/package=BSquare">https://cran.r-project.org/package=BSquare</a>.
</div>
<div id="ref-staudte_2014" class="csl-entry">
Staudte, R. G. 2014. <span>“Inference for Quantile Measures of Kurtosis,
Peakedness and Tail-Weight.”</span> <em>arXiv Preprint arXiv:1047.6461v1
[Math.ST]</em>. <a href="https://doi.org/10.1080/03610926.2015.1056366">https://doi.org/10.1080/03610926.2015.1056366</a>.
</div>
<div id="ref-tukey" class="csl-entry">
Tukey, J. W. 1965. <span>“Which Part of the Sample Contains the
Information?”</span> <em>Proceedings of the National Academy of Sciences
of the United States of America</em> 53 (1): 127–34.
</div>
<div id="ref-mice" class="csl-entry">
van Buuren, S., and K. Groothuis-Oudshoorn. 2011. <span>“Mice:
Multivariate Imputation by Chained Equations in <span>R</span>.”</span>
<em>Journal of Statistical Software</em> 45 (3): 1–67.
</div>
<div id="ref-yu_jones" class="csl-entry">
Yu, K. M., and M. C. Jones. 1998. <span>“Local Linear Quantile
Regression.”</span> <em>Journal of the American Statistical
Association</em> 93 (441): 228–37.
</div>
<div id="ref-zhao_2000" class="csl-entry">
Zhao, Q. S. 2000. <span>“Restricted Regression Quantiles.”</span>
<em>Journal of Multivariate Analysis</em> 72 (1): 78–99.
</div>
<div id="ref-zheng_1998" class="csl-entry">
Zheng, J. X. 1998. <span>“A Consistent Nonparametric Test of Parametric
Regression Models Under Conditional Quantile Restrictions.”</span>
<em>Econometric Theory</em> 14 (1): 123–38.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
